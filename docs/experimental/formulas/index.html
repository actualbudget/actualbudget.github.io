<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-experimental/formulas" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.9.2">
<title data-rh="true">Excel Formula Mode (Formula cards &amp; Rule formulas) | Actual Budget</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://actualbudget.org/img/og.png"><meta data-rh="true" name="twitter:image" content="https://actualbudget.org/img/og.png"><meta data-rh="true" property="og:url" content="https://actualbudget.org/docs/experimental/formulas"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Excel Formula Mode (Formula cards &amp; Rule formulas) | Actual Budget"><meta data-rh="true" name="description" content="This is an experimental feature. That means we’re still working on finishing it. There may be bugs, missing functionality or incomplete documentation, and we may decide to remove the feature in a future release. If you have any feedback, please comment on this feedback issue or post a message in the Discord."><meta data-rh="true" property="og:description" content="This is an experimental feature. That means we’re still working on finishing it. There may be bugs, missing functionality or incomplete documentation, and we may decide to remove the feature in a future release. If you have any feedback, please comment on this feedback issue or post a message in the Discord."><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://actualbudget.org/docs/experimental/formulas"><link data-rh="true" rel="alternate" href="https://actualbudget.org/docs/experimental/formulas" hreflang="en"><link data-rh="true" rel="alternate" href="https://actualbudget.org/docs/experimental/formulas" hreflang="x-default"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Experimental features","item":"https://actualbudget.org/docs/experimental/"},{"@type":"ListItem","position":2,"name":"Excel Formula Mode (Formula cards & Rule formulas)","item":"https://actualbudget.org/docs/experimental/formulas"}]}</script><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Actual Budget Blog RSS Feed"><link rel="stylesheet" href="/assets/css/styles.ddf522dd.css">
<script src="/assets/js/runtime~main.8097a3d1.js" defer="defer"></script>
<script src="/assets/js/main.21b3bcb9.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",t||(window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light")),document.documentElement.setAttribute("data-theme-choice",t||"system")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><link rel="preload" as="image" href="/img/actual.png"><link rel="preload" as="image" href="/assets/images/enable-formula-mode-f4229cabd9ae411c3b383f8c4d964e0e.png"><link rel="preload" as="image" href="/assets/images/add-formula-card-9ab340894ff3431f758bb544ab9830de.png"><link rel="preload" as="image" href="/assets/images/formula-editor-and-queries-0353d909755e2ee51eb21b624be3270f.png"><link rel="preload" as="image" href="/assets/images/rule-formula-toggle-101e9509e80f06f1c28bae518bb94b68.png"><div role="region" aria-label="Skip to main content"><a class="skipToContent_G6ar" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/actual.png" alt="Actual Open Source" class="themedComponent_DHUr themedComponent--light_DIHH"><img src="/img/actual.png" alt="Actual Open Source" class="themedComponent_DHUr themedComponent--dark_Bv2M"></div></a><a class="navbar__item navbar__link" href="/#features">Features</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/">Docs</a><a class="navbar__item navbar__link" href="/blog">Blog</a><a class="navbar__item navbar__link" href="/contact">Contact</a><a class="navbar__item navbar__link" href="/download">Download</a><a href="https://opencollective.com/actual" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Donate<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_awgD"><use href="#theme-svg-external-link"></use></svg></a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><a href="https://discord.gg/8JfAXSgfRf" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Discord<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_awgD"><use href="#theme-svg-external-link"></use></svg></a><a href="https://github.com/actualbudget/actual" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_awgD"><use href="#theme-svg-external-link"></use></svg></a><div class="toggle_OLSw colorModeToggle_Hg9V"><button class="clean-btn toggleButton_wYmb toggleButtonDisabled_vaDU" type="button" disabled="" title="system mode" aria-label="Switch between dark and light mode (currently system mode)"><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_KEbZ lightToggleIcon_Sxwe"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_KEbZ darkToggleIcon_Yem1"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_KEbZ systemToggleIcon_txm5"><path fill="currentColor" d="m12 21c4.971 0 9-4.029 9-9s-4.029-9-9-9-9 4.029-9 9 4.029 9 9 9zm4.95-13.95c1.313 1.313 2.05 3.093 2.05 4.95s-0.738 3.637-2.05 4.95c-1.313 1.313-3.093 2.05-4.95 2.05v-14c1.857 0 3.637 0.737 4.95 2.05z"></path></svg></button></div><div class="navbarSearchContainer_bmvg"><div class="navbar__search searchBarContainer_YZIh" dir="ltr"><input placeholder="Search" aria-label="Search" class="navbar__search-input searchInput_eCKk" value=""><div class="loadingRing_pJhT searchBarLoadingRing_NsvA"><div></div><div></div><div></div><div></div></div></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_UyTV"><div class="docsWrapper_XLvK"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_z1FD" type="button"></button><div class="docRoot_HciC"><aside class="theme-doc-sidebar-container docSidebarContainer_e5ai"><div class="sidebarViewport_N8x0"><div class="sidebar_vJCc"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_qiME"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/"><span title="Introduction" class="linkLabel_PuAu">Introduction</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/vision"><span title="Actual Budget Vision" class="linkLabel_PuAu">Actual Budget Vision</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/releases"><span title="Release Notes" class="linkLabel_PuAu">Release Notes</span></a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_d9ci menu__link menu__link--sublist" href="/docs/tour/"><span title="A Tour of Actual" class="categoryLinkLabel_Oe72">A Tour of Actual</span></a><button aria-label="Expand sidebar category &#x27;A Tour of Actual&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item no-indent"><div class="menu__list-item-collapsible"><a class="categoryLink_d9ci menu__link"><span title="Getting Started" class="categoryLinkLabel_Oe72">Getting Started</span></a></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/getting-started/roadmap-for-new-users"><span title="Roadmap for new users" class="linkLabel_PuAu">Roadmap for new users</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/getting-started/envelope-budgeting"><span title="Envelope budgeting" class="linkLabel_PuAu">Envelope budgeting</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/getting-started/tracking-budget"><span title="Tracking Budget" class="linkLabel_PuAu">Tracking Budget</span></a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_d9ci menu__link menu__link--sublist" tabindex="0" href="/docs/install/"><span title="Installation and Configuration" class="categoryLinkLabel_Oe72">Installation and Configuration</span></a><button aria-label="Expand sidebar category &#x27;Installation and Configuration&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_d9ci menu__link menu__link--sublist" tabindex="0" href="/docs/migration/"><span title="Migration" class="categoryLinkLabel_Oe72">Migration</span></a><button aria-label="Expand sidebar category &#x27;Migration&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item no-indent"><div class="menu__list-item-collapsible"><a class="categoryLink_d9ci menu__link menu__link--active"><span title="Using Actual" class="categoryLinkLabel_Oe72">Using Actual</span></a></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/getting-started/starting-fresh"><span title="Starting Fresh" class="linkLabel_PuAu">Starting Fresh</span></a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_d9ci menu__link menu__link--sublist" tabindex="0" href="/docs/budgeting/"><span title="Budgeting" class="categoryLinkLabel_Oe72">Budgeting</span></a><button aria-label="Expand sidebar category &#x27;Budgeting&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/schedules"><span title="Schedules" class="linkLabel_PuAu">Schedules</span></a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_d9ci menu__link menu__link--sublist" tabindex="0" href="/docs/accounts/"><span title="Accounts &amp; Transactions" class="categoryLinkLabel_Oe72">Accounts &amp; Transactions</span></a><button aria-label="Expand sidebar category &#x27;Accounts &amp; Transactions&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_d9ci menu__link menu__link--sublist" tabindex="0" href="/docs/reports/"><span title="Reports" class="categoryLinkLabel_Oe72">Reports</span></a><button aria-label="Expand sidebar category &#x27;Reports&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_d9ci menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/backup-restore/backup"><span title="Backup &amp; Restore" class="categoryLinkLabel_Oe72">Backup &amp; Restore</span></a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/settings/"><span title="Settings" class="linkLabel_PuAu">Settings</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/getting-started/sync"><span title="Syncing Across Devices" class="linkLabel_PuAu">Syncing Across Devices</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/getting-started/manage-files"><span title="Managing Files" class="linkLabel_PuAu">Managing Files</span></a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_d9ci menu__link menu__link--sublist menu__link--active" tabindex="0" href="/docs/experimental/"><span title="Experimental features" class="categoryLinkLabel_Oe72">Experimental features</span></a><button aria-label="Collapse sidebar category &#x27;Experimental features&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/experimental/goal-templates"><span title="Budget Templates" class="linkLabel_PuAu">Budget Templates</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/experimental/monthly-cleanup"><span title="End of Month Cleanup" class="linkLabel_PuAu">End of Month Cleanup</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/experimental/rule-templating"><span title="Rule Action Templating" class="linkLabel_PuAu">Rule Action Templating</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/experimental/formulas"><span title="Excel Formula Mode (Formula cards &amp; Rule formulas)" class="linkLabel_PuAu">Excel Formula Mode (Formula cards &amp; Rule formulas)</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/experimental/pluggyai"><span title="Pluggy.ai Setup" class="linkLabel_PuAu">Pluggy.ai Setup</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/experimental/crossover-point-report"><span title="Crossover Point Report" class="linkLabel_PuAu">Crossover Point Report</span></a></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/getting-started/tips-tricks"><span title="Tips &amp; Tricks" class="linkLabel_PuAu">Tips &amp; Tricks</span></a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_d9ci menu__link menu__link--sublist" tabindex="0" href="/docs/api/"><span title="API" class="categoryLinkLabel_Oe72">API</span></a><button aria-label="Expand sidebar category &#x27;API&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item no-indent"><div class="menu__list-item-collapsible"><a class="categoryLink_d9ci menu__link"><span title="Help &amp; Support" class="categoryLinkLabel_Oe72">Help &amp; Support</span></a></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/faq"><span title="Frequently Asked Questions" class="linkLabel_PuAu">Frequently Asked Questions</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/actual-server-repo-move"><span title="Actual Server repository move" class="linkLabel_PuAu">Actual Server repository move</span></a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_d9ci menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/troubleshooting/server"><span title="Troubleshooting" class="categoryLinkLabel_Oe72">Troubleshooting</span></a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/community-repos"><span title="Community Projects" class="linkLabel_PuAu">Community Projects</span></a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_d9ci menu__link menu__link--sublist" href="/docs/contributing/"><span title="Contributing" class="categoryLinkLabel_Oe72">Contributing</span></a><button aria-label="Expand sidebar category &#x27;Contributing&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li></ul></nav></div></div></aside><main class="docMainContainer_namt"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_YAwJ"><div class="docItemContainer_Rv5Z"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_zCmv" aria-label="Breadcrumbs"><ul class="breadcrumbs"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_JFrk"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Using Actual</span></li><li class="breadcrumbs__item"><a class="breadcrumbs__link" href="/docs/experimental/"><span>Experimental features</span></a></li><li class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link">Excel Formula Mode (Formula cards &amp; Rule formulas)</span></li></ul></nav><div class="tocCollapsible_O_Qc theme-doc-toc-mobile tocMobile_tjDr"><button type="button" class="clean-btn tocCollapsibleButton_htYj">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Excel Formula Mode (Formula cards &amp; Rule formulas)</h1></header>
<div class="theme-admonition theme-admonition-warning admonition_IZjC alert alert--warning"><div class="admonitionHeading_uVvU"><span class="admonitionIcon_HiR3"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>warning</div><div class="admonitionContent_bl22"><p>This is an <strong>experimental feature</strong>. That means we’re still working on finishing it. There may be bugs, missing functionality or incomplete documentation, and we may decide to remove the feature in a future release. If you have any feedback, please comment on <a href="https://github.com/actualbudget/actual/issues/5949" target="_blank" rel="noopener noreferrer" class="">this feedback issue</a> or post a message in the Discord.</p></div></div>
<div class="theme-admonition theme-admonition-warning admonition_IZjC alert alert--warning"><div class="admonitionHeading_uVvU"><span class="admonitionIcon_HiR3"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>warning</div><div class="admonitionContent_bl22"><p>All functionality described here may not be available in the latest stable release. See <a class="" href="/docs/experimental/">Experimental Features</a> for instructions to enable experimental features. Use the <code>edge</code> images for the latest implementation.</p></div></div>
<p>Excel formula mode adds two related features:</p>
<ul>
<li class=""><strong>Formula cards</strong>: a dashboard/report card that evaluates an Excel-style formula, including totals from custom queries.</li>
<li class=""><strong>Rule formulas</strong>: in the Rules editor, some “set field” actions can be driven by a formula instead of a fixed value.</li>
</ul>
<p>Under the hood, Actual evaluates formulas using <a href="https://hyperformula.handsontable.com/" target="_blank" rel="noopener noreferrer" class="">HyperFormula</a>. Formulas <strong>must start with <code>=</code></strong>.</p>
<h2 class="anchor anchorTargetStickyNavbar_SAay" id="enable-the-feature">Enable the feature<a href="#enable-the-feature" class="hash-link" aria-label="Direct link to Enable the feature" title="Direct link to Enable the feature" translate="no">​</a></h2>
<p>Go to <code>Settings -&gt; Show advanced settings -&gt; Experimental features</code> and enable:</p>
<ul>
<li class=""><strong>Excel formula mode (Formula cards &amp; Rule formulas)</strong></li>
</ul>
<p><img alt="Placeholder: enable Excel formula mode toggle" src="/assets/images/enable-formula-mode-f4229cabd9ae411c3b383f8c4d964e0e.png" width="837" height="466"></p>
<h2 class="anchor anchorTargetStickyNavbar_SAay" id="formula-cards">Formula cards<a href="#formula-cards" class="hash-link" aria-label="Direct link to Formula cards" title="Direct link to Formula cards" translate="no">​</a></h2>
<h3 class="anchor anchorTargetStickyNavbar_SAay" id="add-a-formula-card">Add a Formula card<a href="#add-a-formula-card" class="hash-link" aria-label="Direct link to Add a Formula card" title="Direct link to Add a Formula card" translate="no">​</a></h3>
<ol>
<li class="">Go to <strong>Reports</strong></li>
<li class="">Click <strong>Edit dashboard</strong></li>
<li class="">Click <strong>Add widget</strong></li>
<li class="">Choose <strong>Formula card</strong></li>
</ol>
<p>Click the card to open the editor (where you can save the widget).</p>
<p><img alt="Placeholder: add Formula card from Reports dashboard" src="/assets/images/add-formula-card-9ab340894ff3431f758bb544ab9830de.png" width="427" height="502"></p>
<h3 class="anchor anchorTargetStickyNavbar_SAay" id="write-a-formula">Write a formula<a href="#write-a-formula" class="hash-link" aria-label="Direct link to Write a formula" title="Direct link to Write a formula" translate="no">​</a></h3>
<ul>
<li class=""><strong>Start with <code>=</code></strong> (example: <code>=SUM(1, 2, 3)</code>)</li>
<li class="">You can use typical Excel-style functions (autocomplete and hover help are built into the editor).</li>
</ul>
<h2 class="anchor anchorTargetStickyNavbar_SAay" id="function-reference-autocomplete">Function reference (autocomplete)<a href="#function-reference-autocomplete" class="hash-link" aria-label="Direct link to Function reference (autocomplete)" title="Direct link to Function reference (autocomplete)" translate="no">​</a></h2>
<p>This list documents the functions that appear in the in-app <strong>autocomplete/hover popover</strong> for formulas.</p>
<div class="theme-admonition theme-admonition-tip admonition_IZjC alert alert--success"><div class="admonitionHeading_uVvU"><span class="admonitionIcon_HiR3"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>tip</div><div class="admonitionContent_bl22"><p>If a function isn’t listed here, it still might work. Actual uses HyperFormula under the hood, so you can also refer to <a href="https://hyperformula.handsontable.com/guide/built-in-functions.html" target="_blank" rel="noopener noreferrer" class="">HyperFormula’s built-in functions list</a>.</p></div></div>
<table><thead><tr><th>Function</th><th>Available in</th><th>Description</th><th>Syntax example</th><th>Optional params</th></tr></thead><tbody><tr><td><code>ABS</code></td><td>Query, Rules</td><td>Returns the absolute value of a number.</td><td><code>=ABS(-42)</code></td><td>—</td></tr><tr><td><code>AND</code></td><td>Query, Rules</td><td>Returns TRUE if all arguments are TRUE.</td><td><code>=AND(1=1, 2=2)</code></td><td>Accepts more than 2 conditions</td></tr><tr><td><code>AVERAGE</code></td><td>Query</td><td>Returns the average of all numbers in a range.</td><td><code>=AVERAGE(1, 2, 3)</code></td><td>Accepts more than 2 values</td></tr><tr><td><code>AVERAGEA</code></td><td>Query</td><td>Returns the average, including text and logical values.</td><td><code>=AVERAGEA(1, TRUE, &quot;2&quot;)</code></td><td>Accepts more than 2 values</td></tr><tr><td><code>CEILING</code></td><td>Query, Rules</td><td>Rounds up to nearest multiple of significance.</td><td><code>=CEILING(10.2, 1)</code></td><td>—</td></tr><tr><td><code>CHAR</code></td><td>Query, Rules</td><td>Converts number to character.</td><td><code>=CHAR(65)</code></td><td>—</td></tr><tr><td><code>CHOOSE</code></td><td>Query</td><td>Returns value from list based on index.</td><td><code>=CHOOSE(2, &quot;A&quot;, &quot;B&quot;, &quot;C&quot;)</code></td><td>Accepts more than 2 values</td></tr><tr><td><code>CLEAN</code></td><td>Rules</td><td>Removes non-printable characters from text.</td><td><code>=CLEAN(notes)</code></td><td>—</td></tr><tr><td><code>CODE</code></td><td>Query, Rules</td><td>Returns numeric code for first character.</td><td><code>=CODE(&quot;A&quot;)</code></td><td>—</td></tr><tr><td><code>CONCATENATE</code></td><td>Query, Rules</td><td>Combines several text strings into one.</td><td><code>=CONCATENATE(&quot;Paid &quot;, payee_name)</code></td><td>Accepts more than 2 texts</td></tr><tr><td><code>COS</code></td><td>Query</td><td>Returns the cosine of an angle.</td><td><code>=COS(1)</code></td><td>—</td></tr><tr><td><code>COUNT</code></td><td>Query</td><td>Counts the number of numeric values.</td><td><code>=COUNT(1, 2, &quot;x&quot;)</code></td><td>Accepts more than 2 values</td></tr><tr><td><code>COUNTA</code></td><td>Query</td><td>Counts non-empty values.</td><td><code>=COUNTA(1, &quot;&quot;, &quot;x&quot;)</code></td><td>Accepts more than 2 values</td></tr><tr><td><code>COUNTBLANK</code></td><td>Query</td><td>Counts empty cells.</td><td><code>=COUNTBLANK(A1:A10)</code></td><td>—</td></tr><tr><td><code>COUNTIF</code></td><td>Query</td><td>Counts cells that meet a criteria.</td><td><code>=COUNTIF(A1:A10, &quot;&gt;0&quot;)</code></td><td>—</td></tr><tr><td><code>COUNTIFS</code></td><td>Query</td><td>Counts cells that meet multiple criteria.</td><td><code>=COUNTIFS(A1:A10, &quot;&gt;0&quot;, B1:B10, &quot;&lt;=5&quot;)</code></td><td>Repeat <code>(range, criteria)</code> pairs</td></tr><tr><td><code>DATE</code></td><td>Query, Rules</td><td>Returns date as number of days since null date.</td><td><code>=DATE(2025, 12, 16)</code></td><td>—</td></tr><tr><td><code>DATEDIF</code></td><td>Query, Rules</td><td>Calculates distance between dates.</td><td><code>=DATEDIF(&quot;2025-01-01&quot;, &quot;2025-12-31&quot;, &quot;D&quot;)</code></td><td>—</td></tr><tr><td><code>DATEVALUE</code></td><td>Rules</td><td>Parses a date string and returns it as a number.</td><td><code>=DATEVALUE(&quot;2025-12-16&quot;)</code></td><td>—</td></tr><tr><td><code>DAY</code></td><td>Query, Rules</td><td>Returns the day from a date.</td><td><code>=DAY(date)</code></td><td>—</td></tr><tr><td><code>DAYS</code></td><td>Query, Rules</td><td>Calculates difference between dates in days.</td><td><code>=DAYS(&quot;2025-12-31&quot;, &quot;2025-12-01&quot;)</code></td><td>—</td></tr><tr><td><code>EDATE</code></td><td>Query, Rules</td><td>Returns date shifted by specified months.</td><td><code>=EDATE(date, 1)</code></td><td>—</td></tr><tr><td><code>EOMONTH</code></td><td>Query, Rules</td><td>Returns last day of month after specified months.</td><td><code>=EOMONTH(date, 0)</code></td><td>—</td></tr><tr><td><code>EXACT</code></td><td>Query, Rules</td><td>Returns TRUE if texts are exactly the same.</td><td><code>=EXACT(&quot;A&quot;, &quot;a&quot;)</code></td><td>—</td></tr><tr><td><code>EXP</code></td><td>Query</td><td>Returns e raised to the power of number.</td><td><code>=EXP(1)</code></td><td>—</td></tr><tr><td><code>FALSE</code></td><td>Query, Rules</td><td>Returns the logical value FALSE.</td><td><code>=FALSE()</code></td><td>—</td></tr><tr><td><code>FIND</code></td><td>Query, Rules</td><td>Finds text within text (case-sensitive).</td><td><code>=FIND(&quot;foo&quot;, notes)</code></td><td>—</td></tr><tr><td><code>FLOOR</code></td><td>Query, Rules</td><td>Rounds down to nearest multiple of significance.</td><td><code>=FLOOR(10.8, 1)</code></td><td>—</td></tr><tr><td><code>FV</code></td><td>Query</td><td>Calculates future value of investment.</td><td><code>=FV(0.05/12, 12, -100)</code></td><td>—</td></tr><tr><td><code>HLOOKUP</code></td><td>Query</td><td>Searches horizontally in first row and returns value.</td><td><code>=HLOOKUP(&quot;key&quot;, A1:D10, 2, TRUE)</code></td><td>—</td></tr><tr><td><code>IF</code></td><td>Query, Rules</td><td>Returns one value if condition is TRUE, another if FALSE.</td><td><code>=IF(amount&lt;0, &quot;Expense&quot;, &quot;Income&quot;)</code></td><td>—</td></tr><tr><td><code>IFERROR</code></td><td>Query, Rules</td><td>Returns value if no error, otherwise returns alternative.</td><td><code>=IFERROR(1/0, 0)</code></td><td>—</td></tr><tr><td><code>IFNA</code></td><td>Query, Rules</td><td>Returns value if not #N/A error, otherwise returns alternative.</td><td><code>=IFNA(VLOOKUP(&quot;x&quot;, A1:B10, 2, FALSE), 0)</code></td><td>—</td></tr><tr><td><code>IFS</code></td><td>Query, Rules</td><td>Checks multiple conditions and returns corresponding values.</td><td><code>=IFS(amount&lt;0, &quot;Expense&quot;, amount&gt;0, &quot;Income&quot;)</code></td><td>Repeat <code>(condition, value)</code> pairs</td></tr><tr><td><code>INDEX</code></td><td>Query</td><td>Returns value at specified row and column.</td><td><code>=INDEX(A1:C10, 2, 3)</code></td><td>—</td></tr><tr><td><code>INTEGER_TO_AMOUNT</code></td><td>Query, Rules</td><td>Converts integer amount to decimal amount (e.g., 1234 -&gt; 12.34).</td><td><code>=INTEGER_TO_AMOUNT(amount, 2)</code></td><td><code>decimal_places</code> (default: 2)</td></tr><tr><td><code>INT</code></td><td>Rules</td><td>Rounds down to nearest integer.</td><td><code>=INT(10.9)</code></td><td>—</td></tr><tr><td><code>IRR</code></td><td>Query</td><td>Calculates internal rate of return.</td><td><code>=IRR(A1:A12)</code></td><td>—</td></tr><tr><td><code>ISEVEN</code></td><td>Rules</td><td>Returns TRUE if number is even.</td><td><code>=ISEVEN(10)</code></td><td>—</td></tr><tr><td><code>ISODD</code></td><td>Rules</td><td>Returns TRUE if number is odd.</td><td><code>=ISODD(11)</code></td><td>—</td></tr><tr><td><code>ISBLANK</code></td><td>Query, Rules</td><td>Returns TRUE if value is blank.</td><td><code>=ISBLANK(notes)</code></td><td>—</td></tr><tr><td><code>ISERROR</code></td><td>Query, Rules</td><td>Returns TRUE if value is any error.</td><td><code>=ISERROR(1/0)</code></td><td>—</td></tr><tr><td><code>ISLOGICAL</code></td><td>Query, Rules</td><td>Returns TRUE if value is logical (TRUE/FALSE).</td><td><code>=ISLOGICAL(TRUE())</code></td><td>—</td></tr><tr><td><code>ISNA</code></td><td>Query, Rules</td><td>Returns TRUE if value is #N/A error.</td><td><code>=ISNA(NA())</code></td><td>—</td></tr><tr><td><code>ISNUMBER</code></td><td>Query, Rules</td><td>Returns TRUE if value is a number.</td><td><code>=ISNUMBER(amount)</code></td><td>—</td></tr><tr><td><code>ISOWEEKNUM</code></td><td>Rules</td><td>Returns ISO week number.</td><td><code>=ISOWEEKNUM(date)</code></td><td>—</td></tr><tr><td><code>ISREF</code></td><td>Query, Rules</td><td>Returns TRUE if value is a reference.</td><td><code>=ISREF(A1)</code></td><td>—</td></tr><tr><td><code>ISTEXT</code></td><td>Query, Rules</td><td>Returns TRUE if value is text.</td><td><code>=ISTEXT(notes)</code></td><td>—</td></tr><tr><td><code>LEFT</code></td><td>Query, Rules</td><td>Returns leftmost characters from text.</td><td><code>=LEFT(imported_payee, 10)</code></td><td>—</td></tr><tr><td><code>LEN</code></td><td>Query, Rules</td><td>Returns length of text.</td><td><code>=LEN(notes)</code></td><td>—</td></tr><tr><td><code>LN</code></td><td>Query</td><td>Returns the natural logarithm.</td><td><code>=LN(10)</code></td><td>—</td></tr><tr><td><code>LOG</code></td><td>Query</td><td>Returns the logarithm to specified base.</td><td><code>=LOG(100, 10)</code></td><td>—</td></tr><tr><td><code>LOG10</code></td><td>Query</td><td>Returns the base-10 logarithm.</td><td><code>=LOG10(1000)</code></td><td>—</td></tr><tr><td><code>LOOKUP</code></td><td>Query</td><td>Looks up values in a vector or array.</td><td><code>=LOOKUP(&quot;x&quot;, A1:A10)</code></td><td>—</td></tr><tr><td><code>LOWER</code></td><td>Query, Rules</td><td>Converts text to lowercase.</td><td><code>=LOWER(notes)</code></td><td>—</td></tr><tr><td><code>MATCH</code></td><td>Query</td><td>Returns position of value in array.</td><td><code>=MATCH(&quot;x&quot;, A1:A10, 0)</code></td><td>—</td></tr><tr><td><code>MAX</code></td><td>Query</td><td>Returns the maximum value.</td><td><code>=MAX(1, 2, 3)</code></td><td>Accepts more than 2 values</td></tr><tr><td><code>MAXA</code></td><td>Query</td><td>Returns the maximum value, including text and logical values.</td><td><code>=MAXA(1, TRUE, &quot;2&quot;)</code></td><td>Accepts more than 2 values</td></tr><tr><td><code>MEDIAN</code></td><td>Query</td><td>Returns the median value.</td><td><code>=MEDIAN(1, 2, 100)</code></td><td>Accepts more than 2 values</td></tr><tr><td><code>MID</code></td><td>Query, Rules</td><td>Returns substring from specified position.</td><td><code>=MID(notes, 1, 10)</code></td><td>—</td></tr><tr><td><code>MIN</code></td><td>Query</td><td>Returns the minimum value.</td><td><code>=MIN(1, 2, 3)</code></td><td>Accepts more than 2 values</td></tr><tr><td><code>MINA</code></td><td>Query</td><td>Returns the minimum value, including text and logical values.</td><td><code>=MINA(1, TRUE, &quot;2&quot;)</code></td><td>Accepts more than 2 values</td></tr><tr><td><code>MOD</code></td><td>Query, Rules</td><td>Returns the remainder of division.</td><td><code>=MOD(10, 3)</code></td><td>—</td></tr><tr><td><code>MODE</code></td><td>Query</td><td>Returns the most frequently occurring value.</td><td><code>=MODE(1, 1, 2)</code></td><td>Accepts more than 2 values</td></tr><tr><td><code>MONTH</code></td><td>Query, Rules</td><td>Returns the month from a date.</td><td><code>=MONTH(date)</code></td><td>—</td></tr><tr><td><code>N</code></td><td>Rules</td><td>Converts value to a number.</td><td><code>=N(TRUE())</code></td><td>—</td></tr><tr><td><code>NETWORKDAYS</code></td><td>Query</td><td>Returns number of working days between dates.</td><td><code>=NETWORKDAYS(&quot;2025-12-01&quot;, &quot;2025-12-31&quot;)</code></td><td>—</td></tr><tr><td><code>NOT</code></td><td>Query, Rules</td><td>Reverses the logical value.</td><td><code>=NOT(amount&lt;0)</code></td><td>—</td></tr><tr><td><code>NOW</code></td><td>Query, Rules</td><td>Returns current date and time.</td><td><code>=NOW()</code></td><td>—</td></tr><tr><td><code>NPV</code></td><td>Query</td><td>Calculates net present value.</td><td><code>=NPV(0.1, -1000, 200, 300)</code></td><td>Accepts more than 2 values</td></tr><tr><td><code>OR</code></td><td>Query, Rules</td><td>Returns TRUE if any argument is TRUE.</td><td><code>=OR(amount&lt;0, amount&gt;0)</code></td><td>Accepts more than 2 conditions</td></tr><tr><td><code>PERCENTILE</code></td><td>Query</td><td>Returns the k-th percentile.</td><td><code>=PERCENTILE(A1:A100, 0.9)</code></td><td>—</td></tr><tr><td><code>PI</code></td><td>Query</td><td>Returns the value of PI.</td><td><code>=PI()</code></td><td>—</td></tr><tr><td><code>PMT</code></td><td>Query</td><td>Calculates payment for a loan.</td><td><code>=PMT(0.05/12, 60, 10000)</code></td><td>—</td></tr><tr><td><code>POWER</code></td><td>Query, Rules</td><td>Returns base raised to the power of exponent.</td><td><code>=POWER(2, 8)</code></td><td>—</td></tr><tr><td><code>PROPER</code></td><td>Query, Rules</td><td>Capitalizes first letter of each word.</td><td><code>=PROPER(notes)</code></td><td>—</td></tr><tr><td><code>PRODUCT</code></td><td>Query</td><td>Returns the product of all numbers.</td><td><code>=PRODUCT(2, 3, 4)</code></td><td>Accepts more than 2 values</td></tr><tr><td><code>PV</code></td><td>Query</td><td>Calculates present value of investment.</td><td><code>=PV(0.05/12, 12, -100)</code></td><td>—</td></tr><tr><td><code>QUARTILE</code></td><td>Query</td><td>Returns the quartile of a dataset.</td><td><code>=QUARTILE(A1:A100, 1)</code></td><td>—</td></tr><tr><td><code>QUERY</code></td><td>Query</td><td>Execute a query and return the result.</td><td><code>=QUERY(&quot;expenses&quot;)</code></td><td>—</td></tr><tr><td><code>QUERY_COUNT</code></td><td>Query</td><td>Execute a query and return the number of matching rows.</td><td><code>=QUERY_COUNT(&quot;expenses&quot;)</code></td><td>—</td></tr><tr><td><code>RANK</code></td><td>Query</td><td>Returns the rank of a number in a list.</td><td><code>=RANK(10, A1:A10, 0)</code></td><td>—</td></tr><tr><td><code>RATE</code></td><td>Query</td><td>Calculates interest rate per period.</td><td><code>=RATE(60, -200, 10000)</code></td><td>—</td></tr><tr><td><code>REPLACE</code></td><td>Query, Rules</td><td>Replaces substring at specified position.</td><td><code>=REPLACE(notes, 1, 5, &quot;&quot;)</code></td><td>—</td></tr><tr><td><code>REPT</code></td><td>Query, Rules</td><td>Repeats text specified number of times.</td><td><code>=REPT(&quot;*&quot;, 10)</code></td><td>—</td></tr><tr><td><code>RIGHT</code></td><td>Query, Rules</td><td>Returns rightmost characters from text.</td><td><code>=RIGHT(imported_payee, 4)</code></td><td>—</td></tr><tr><td><code>ROUND</code></td><td>Query, Rules</td><td>Rounds a number to specified decimals.</td><td><code>=ROUND(amount/100, 2)</code></td><td>—</td></tr><tr><td><code>ROUNDDOWN</code></td><td>Query, Rules</td><td>Rounds down to specified decimals.</td><td><code>=ROUNDDOWN(amount/100, 0)</code></td><td>—</td></tr><tr><td><code>ROUNDUP</code></td><td>Query, Rules</td><td>Rounds up to specified decimals.</td><td><code>=ROUNDUP(amount/100, 0)</code></td><td>—</td></tr><tr><td><code>SEARCH</code></td><td>Query, Rules</td><td>Finds text within text (case-insensitive, supports wildcards).</td><td><code>=SEARCH(&quot;foo&quot;, notes)</code></td><td>—</td></tr><tr><td><code>SIGN</code></td><td>Rules</td><td>Returns -1 for negative, 0 for zero, 1 for positive.</td><td><code>=SIGN(amount)</code></td><td>—</td></tr><tr><td><code>SIN</code></td><td>Query</td><td>Returns the sine of an angle.</td><td><code>=SIN(1)</code></td><td>—</td></tr><tr><td><code>SPLIT</code></td><td>Rules</td><td>Splits text by space and returns part at index.</td><td><code>=SPLIT(imported_payee, 0)</code></td><td>—</td></tr><tr><td><code>SQRT</code></td><td>Query, Rules</td><td>Returns the square root.</td><td><code>=SQRT(9)</code></td><td>—</td></tr><tr><td><code>STDEV</code></td><td>Query</td><td>Returns the standard deviation of a sample.</td><td><code>=STDEV(A1:A10)</code></td><td>—</td></tr><tr><td><code>STDEVP</code></td><td>Query</td><td>Returns the standard deviation of a population.</td><td><code>=STDEVP(A1:A10)</code></td><td>—</td></tr><tr><td><code>SUBSTITUTE</code></td><td>Query, Rules</td><td>Replaces occurrences of text.</td><td><code>=SUBSTITUTE(imported_payee, &quot; 12345&quot;, &quot;&quot;)</code></td><td>—</td></tr><tr><td><code>SUM</code></td><td>Query, Rules</td><td>Returns the sum of all numbers in a range.</td><td><code>=SUM(1, 2, 3)</code></td><td>Accepts more than 2 values</td></tr><tr><td><code>SUMIF</code></td><td>Query</td><td>Sums cells that meet a criteria.</td><td><code>=SUMIF(A1:A10, &quot;&gt;0&quot;, B1:B10)</code></td><td>—</td></tr><tr><td><code>SUMIFS</code></td><td>Query</td><td>Sums cells that meet multiple criteria.</td><td><code>=SUMIFS(B1:B10, A1:A10, &quot;&gt;0&quot;, C1:C10, &quot;X&quot;)</code></td><td>Repeat <code>(range, criteria)</code> pairs</td></tr><tr><td><code>SUMPRODUCT</code></td><td>Query</td><td>Multiplies corresponding elements and returns the sum.</td><td><code>=SUMPRODUCT(A1:A10, B1:B10)</code></td><td>Accepts more arrays</td></tr><tr><td><code>SUMSQ</code></td><td>Query</td><td>Returns the sum of the squares.</td><td><code>=SUMSQ(1, 2, 3)</code></td><td>Accepts more than 2 values</td></tr><tr><td><code>SWITCH</code></td><td>Query, Rules</td><td>Matches expression against values and returns corresponding result.</td><td><code>=SWITCH(category_name, &quot;Groceries&quot;, &quot;Food&quot;, &quot;Fuel&quot;, &quot;Transport&quot;)</code></td><td>Repeat <code>(value, result)</code> pairs; default supported</td></tr><tr><td><code>T</code></td><td>Rules</td><td>Returns text if value is text, empty string otherwise.</td><td><code>=T(notes)</code></td><td>—</td></tr><tr><td><code>TAN</code></td><td>Query</td><td>Returns the tangent of an angle.</td><td><code>=TAN(1)</code></td><td>—</td></tr><tr><td><code>TEXT</code></td><td>Query, Rules</td><td>Converts number to text with format.</td><td><code>=TEXT(date, &quot;MMMM yyyy&quot;)</code></td><td>—</td></tr><tr><td><code>TODAY</code></td><td>Query, Rules</td><td>Returns current date.</td><td><code>=TODAY()</code></td><td>—</td></tr><tr><td><code>TRIM</code></td><td>Query, Rules</td><td>Removes extra spaces from text.</td><td><code>=TRIM(notes)</code></td><td>—</td></tr><tr><td><code>TRUNC</code></td><td>Rules</td><td>Truncates number to specified decimals.</td><td><code>=TRUNC(amount/100, 0)</code></td><td>—</td></tr><tr><td><code>TRUE</code></td><td>Query, Rules</td><td>Returns the logical value TRUE.</td><td><code>=TRUE()</code></td><td>—</td></tr><tr><td><code>UPPER</code></td><td>Query, Rules</td><td>Converts text to uppercase.</td><td><code>=UPPER(notes)</code></td><td>—</td></tr><tr><td><code>VALUE</code></td><td>Rules</td><td>Converts text to a number.</td><td><code>=VALUE(&quot;123.45&quot;)</code></td><td>—</td></tr><tr><td><code>VAR</code></td><td>Query</td><td>Returns the variance of a sample.</td><td><code>=VAR(A1:A10)</code></td><td>—</td></tr><tr><td><code>VARP</code></td><td>Query</td><td>Returns the variance of a population.</td><td><code>=VARP(A1:A10)</code></td><td>—</td></tr><tr><td><code>VLOOKUP</code></td><td>Query</td><td>Searches vertically in first column and returns value.</td><td><code>=VLOOKUP(&quot;key&quot;, A1:D10, 2, TRUE)</code></td><td>—</td></tr><tr><td><code>WEEKDAY</code></td><td>Query, Rules</td><td>Returns day of week (1-7).</td><td><code>=WEEKDAY(date, 1)</code></td><td>—</td></tr><tr><td><code>WEEKNUM</code></td><td>Query, Rules</td><td>Returns week number of year.</td><td><code>=WEEKNUM(date, 1)</code></td><td>—</td></tr><tr><td><code>XOR</code></td><td>Query, Rules</td><td>Returns TRUE if odd number of arguments are TRUE.</td><td><code>=XOR(TRUE(), FALSE())</code></td><td>Accepts more than 2 conditions</td></tr><tr><td><code>YEAR</code></td><td>Query, Rules</td><td>Returns the year from a date.</td><td><code>=YEAR(date)</code></td><td>—</td></tr></tbody></table>
<h3 class="anchor anchorTargetStickyNavbar_SAay" id="use-queries-with-queryname-and-query_countname">Use queries with <code>QUERY(&quot;name&quot;)</code> and <code>QUERY_COUNT(&quot;name&quot;)</code><a href="#use-queries-with-queryname-and-query_countname" class="hash-link" aria-label="Direct link to use-queries-with-queryname-and-query_countname" title="Direct link to use-queries-with-queryname-and-query_countname" translate="no">​</a></h3>
<p>Formula cards can reference <strong>named queries</strong> that you define in the right-side panel (<strong>Query Definitions</strong>).</p>
<ul>
<li class=""><code>QUERY(&quot;myQuery&quot;)</code> returns the <strong>sum of transaction amounts</strong> for that query’s filters and date range (returned in normal “money” units, e.g. <code>-123.45</code>).</li>
<li class="">If a query name doesn’t exist, it evaluates as <strong>0</strong>.</li>
</ul>
<p>Example:</p>
<div class="language-text codeBlockContainer_ZGJx theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_kX1v"><pre tabindex="0" class="prism-code language-text codeBlock_TAPP thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_AdAo"><span class="token-line" style="color:#393A34"><span class="token plain">=QUERY(&quot;income&quot;) - QUERY(&quot;expenses&quot;)</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_SAay" id="define-a-query">Define a query<a href="#define-a-query" class="hash-link" aria-label="Direct link to Define a query" title="Direct link to Define a query" translate="no">​</a></h3>
<p>In the Formula editor page, use <strong>Query Definitions</strong>:</p>
<ol>
<li class=""><strong>Add Query</strong> and give it a name (the name is what you reference in <code>QUERY(&quot;...&quot;)</code>)</li>
<li class="">Set the date range:<!-- -->
<ul>
<li class=""><strong>Live</strong>: keeps the range moving (e.g. “last 3 months”)</li>
<li class=""><strong>Static</strong>: fixed start/end dates</li>
</ul>
</li>
<li class="">Add <strong>Filters</strong> (same style as report filters)</li>
</ol>
<p><img alt="Placeholder: formula editor and Query Definitions panel" src="/assets/images/formula-editor-and-queries-0353d909755e2ee51eb21b624be3270f.png" width="2170" height="1327"></p>
<h3 class="anchor anchorTargetStickyNavbar_SAay" id="optional-conditional-color">Optional: conditional color<a href="#optional-conditional-color" class="hash-link" aria-label="Direct link to Optional: conditional color" title="Direct link to Optional: conditional color" translate="no">​</a></h3>
<p>Formula cards support an optional <strong>Conditional color</strong> formula (single line) that returns a color string like <code>red</code> or <code>#ff0000</code>.</p>
<ul>
<li class="">Use the <strong><code>RESULT</code></strong> variable to reference the main formula result.</li>
</ul>
<h2 class="anchor anchorTargetStickyNavbar_SAay" id="rule-formulas">Rule formulas<a href="#rule-formulas" class="hash-link" aria-label="Direct link to Rule formulas" title="Direct link to Rule formulas" translate="no">​</a></h2>
<p>Rule formulas let you compute a value from the current transaction and set a field to that computed result.</p>
<p>Note: rule formula inputs are <strong>single-line</strong> (line breaks are automatically replaced with spaces).</p>
<h3 class="anchor anchorTargetStickyNavbar_SAay" id="where-to-find-the-formula-toggle">Where to find the formula toggle<a href="#where-to-find-the-formula-toggle" class="hash-link" aria-label="Direct link to Where to find the formula toggle" title="Direct link to Where to find the formula toggle" translate="no">​</a></h3>
<p>In <strong>More -&gt; Rules -&gt; edit a rule</strong>, on a <strong>Set</strong> action:</p>
<ul>
<li class="">Click the <strong>ƒ</strong> button to the right of the action input to enable/disable <strong>formula mode</strong> for that action.</li>
<li class="">Formula mode is not available for actions that set <strong>payee</strong>, <strong>category</strong>, or <strong>account</strong> (those values are IDs).</li>
<li class="">Rule action templating (the <code>&lt;/&gt;</code> icon) and formulas are mutually exclusive: enabling one disables the other.</li>
</ul>
<p><img alt="Placeholder: Rule action formula toggle (ƒ)" src="/assets/images/rule-formula-toggle-101e9509e80f06f1c28bae518bb94b68.png" width="1338" height="718"></p>
<h3 class="anchor anchorTargetStickyNavbar_SAay" id="available-variables">Available variables<a href="#available-variables" class="hash-link" aria-label="Direct link to Available variables" title="Direct link to Available variables" translate="no">​</a></h3>
<p>Rule formulas evaluate with named variables from the transaction context, including:</p>
<p><strong>Date variables:</strong></p>
<ul>
<li class=""><code>today</code> — Current date in YYYY-MM-DD format (e.g., <code>&quot;2025-12-19&quot;</code>)</li>
<li class=""><code>date</code> — Transaction date in YYYY-MM-DD format (e.g., <code>&quot;2025-01-15&quot;</code>)</li>
</ul>
<p><strong>Numeric variables (stored in cents):</strong></p>
<ul>
<li class=""><code>amount</code> — Transaction amount as an integer in cents (e.g., <code>12345</code> represents $123.45)<!-- -->
<ul>
<li class="">Positive for income, negative for expenses</li>
<li class="">To convert to dollars: <code>=amount / 100</code></li>
</ul>
</li>
<li class=""><code>balance</code> — Account balance after this transaction, as an integer in cents<!-- -->
<ul>
<li class="">Represents the running balance at this transaction</li>
<li class="">To convert to dollars: <code>=balance / 100</code></li>
</ul>
</li>
</ul>
<p><strong>Text variables:</strong></p>
<ul>
<li class=""><code>notes</code> — Transaction notes/memo field (string, may be empty)</li>
<li class=""><code>imported_payee</code> — Original payee name from import before any rules applied (string)</li>
<li class=""><code>payee_name</code> — Resolved payee name (string)</li>
<li class=""><code>account_name</code> — Account name where transaction exists (string)</li>
<li class=""><code>category_name</code> — Category name assigned to transaction (string)</li>
</ul>
<p><strong>Boolean variables:</strong></p>
<ul>
<li class=""><code>cleared</code> — Whether transaction is cleared (<code>TRUE</code> or <code>FALSE</code>)</li>
<li class=""><code>reconciled</code> — Whether transaction is reconciled (<code>TRUE</code> or <code>FALSE</code>)</li>
</ul>
<p>Tip: if you want “dollars” from <code>amount</code>, use <code>=amount / 100</code>.</p>
<h3 class="anchor anchorTargetStickyNavbar_SAay" id="result-types">Result types<a href="#result-types" class="hash-link" aria-label="Direct link to Result types" title="Direct link to Result types" translate="no">​</a></h3>
<p>When a rule runs, Actual converts the formula result to the field type:</p>
<ul>
<li class=""><strong>number fields</strong>: must produce a number (or a string that parses as a number)</li>
<li class=""><strong>date fields</strong>: must produce a valid date</li>
<li class=""><strong>boolean fields</strong>: <code>TRUE</code>/<code>FALSE</code> (or a string that equals <code>&quot;true&quot;</code>/<code>&quot;false&quot;</code>)</li>
<li class=""><strong>string fields</strong>: converted with <code>String(...)</code></li>
</ul></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col noPrint_HJkF"><a href="https://github.com/actualbudget/actual/tree/master/packages/docs/docs/experimental/formulas.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_UohW" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_g62E"></div></div></footer></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/experimental/rule-templating"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Rule Action Templating</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/experimental/pluggyai"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Pluggy.ai Setup</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_TN1Q thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#enable-the-feature" class="table-of-contents__link toc-highlight">Enable the feature</a></li><li><a href="#formula-cards" class="table-of-contents__link toc-highlight">Formula cards</a><ul><li><a href="#add-a-formula-card" class="table-of-contents__link toc-highlight">Add a Formula card</a></li><li><a href="#write-a-formula" class="table-of-contents__link toc-highlight">Write a formula</a></li></ul></li><li><a href="#function-reference-autocomplete" class="table-of-contents__link toc-highlight">Function reference (autocomplete)</a><ul><li><a href="#use-queries-with-queryname-and-query_countname" class="table-of-contents__link toc-highlight">Use queries with <code>QUERY(&quot;name&quot;)</code> and <code>QUERY_COUNT(&quot;name&quot;)</code></a></li><li><a href="#define-a-query" class="table-of-contents__link toc-highlight">Define a query</a></li><li><a href="#optional-conditional-color" class="table-of-contents__link toc-highlight">Optional: conditional color</a></li></ul></li><li><a href="#rule-formulas" class="table-of-contents__link toc-highlight">Rule formulas</a><ul><li><a href="#where-to-find-the-formula-toggle" class="table-of-contents__link toc-highlight">Where to find the formula toggle</a></li><li><a href="#available-variables" class="table-of-contents__link toc-highlight">Available variables</a></li><li><a href="#result-types" class="table-of-contents__link toc-highlight">Result types</a></li></ul></li></ul></div></div></div></div></main></div></div></div><footer class="theme-layout-footer footer footer--dark"><div class="container container-fluid"><div class="footer__links text--center"><div class="footer__links"><a href="https://discord.gg/8JfAXSgfRf" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_awgD"><use href="#theme-svg-external-link"></use></svg></a><span class="footer__link-separator">·</span><a href="https://github.com/actualbudget/actual" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_awgD"><use href="#theme-svg-external-link"></use></svg></a><span class="footer__link-separator">·</span><a href="https://opencollective.com/actual" target="_blank" rel="noopener noreferrer" class="footer__link-item">Donate<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_awgD"><use href="#theme-svg-external-link"></use></svg></a><span class="footer__link-separator">·</span><a href="https://github.com/actualbudget/actual/tree/master/packages/docs" target="_blank" rel="noopener noreferrer" class="footer__link-item">Website Source<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_awgD"><use href="#theme-svg-external-link"></use></svg></a><span class="footer__link-separator">·</span><a class="footer__link-item" href="/docs/privacy-policy">Privacy Policy</a><span class="footer__link-separator">·</span><a href="https://actualbudget.org/blog/rss.xml" target="_blank" rel="noopener noreferrer" class="footer__link-item">RSS Feed<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_awgD"><use href="#theme-svg-external-link"></use></svg></a></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2025 Actual Budget. Built with Docusaurus.</div></div></div></footer></div>
</body>
</html>