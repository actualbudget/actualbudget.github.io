"use strict";(globalThis.webpackChunkdocs=globalThis.webpackChunkdocs||[]).push([[9214],{5481:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>l,contentTitle:()=>d,default:()=>a,frontMatter:()=>t,metadata:()=>r,toc:()=>c});const r=JSON.parse('{"id":"config/oauth-auth","title":"Authenticating With an OpenID Provider","description":"Setup","source":"@site/docs/config/oauth-auth.md","sourceDirName":"config","slug":"/config/oauth-auth","permalink":"/docs/config/oauth-auth","draft":false,"unlisted":false,"editUrl":"https://github.com/actualbudget/actual/tree/master/packages/docs/docs/config/oauth-auth.md","tags":[],"version":"current","frontMatter":{},"sidebar":"docs","previous":{"title":"Using a Reverse Proxy","permalink":"/docs/config/reverse-proxies"},"next":{"title":"Managing Multi-User Support","permalink":"/docs/config/multi-user"}}');var o=i(31085),s=i(71184);const t={},d="Authenticating With an OpenID Provider",l={},c=[{value:"Setup",id:"setup",level:2},{value:"Configuration Using a Configuration File",id:"configuration-using-a-configuration-file",level:3},{value:"Configuration Using Environment Variables",id:"configuration-using-environment-variables",level:3},{value:"Configuring OpenID Using the UI",id:"configuring-openid-using-the-ui",level:3},{value:"Instructions",id:"instructions",level:5},{value:"Tested Providers",id:"tested-providers",level:4},{value:"After Setup",id:"after-setup",level:4},{value:"Environment Variables",id:"environment-variables",level:3},{value:"<code>ACTUAL_OPENID_DISCOVERY_URL</code>",id:"actual_openid_discovery_url",level:4},{value:"<code>ACTUAL_OPENID_CLIENT_ID</code>",id:"actual_openid_client_id",level:4},{value:"<code>ACTUAL_OPENID_CLIENT_SECRET</code>",id:"actual_openid_client_secret",level:4},{value:"<code>ACTUAL_OPENID_SERVER_HOSTNAME</code>",id:"actual_openid_server_hostname",level:4},{value:"<code>ACTUAL_OPENID_AUTHORIZATION_ENDPOINT</code>",id:"actual_openid_authorization_endpoint",level:4},{value:"<code>ACTUAL_OPENID_TOKEN_ENDPOINT</code>",id:"actual_openid_token_endpoint",level:4},{value:"<code>ACTUAL_OPENID_USERINFO_ENDPOINT</code>",id:"actual_openid_userinfo_endpoint",level:4},{value:"<code>ACTUAL_OPENID_AUTH_METHOD</code>",id:"actual_openid_auth_method",level:4},{value:"<code>ACTUAL_OPENID_ENFORCE</code>",id:"actual_openid_enforce",level:4},{value:"<code>ACTUAL_TOKEN_EXPIRATION</code>",id:"actual_token_expiration",level:4}];function h(e){const n={a:"a",admonition:"admonition",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",h4:"h4",h5:"h5",header:"header",img:"img",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,s.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(n.header,{children:(0,o.jsx)(n.h1,{id:"authenticating-with-an-openid-provider",children:"Authenticating With an OpenID Provider"})}),"\n",(0,o.jsx)(n.h2,{id:"setup",children:"Setup"}),"\n",(0,o.jsx)(n.admonition,{type:"info",children:(0,o.jsxs)(n.p,{children:["This feature requires use of ",(0,o.jsx)(n.a,{href:"../config/",children:"Actual Server"})]})}),"\n",(0,o.jsx)(n.p,{children:"If you require a more robust authentication method than a server password, it is recommended to use an OpenID provider. Most OpenID providers support multi-factor authentication, enhancing your application's security. Additionally, if you need support for multiple users, you must enable this feature."}),"\n",(0,o.jsxs)(n.p,{children:["To enable this feature, you can use a ",(0,o.jsx)(n.a,{href:"/docs/config/",children:"configuration file"})," ",(0,o.jsx)(n.code,{children:"config.json"})," on the Actual server, or use the UI."]}),"\n",(0,o.jsx)(n.h3,{id:"configuration-using-a-configuration-file",children:"Configuration Using a Configuration File"}),"\n",(0,o.jsx)(n.p,{children:"If your OpenID provider supports discovery, use the following configuration example:"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-json",metastring:'title="config.json"',children:'"openId": {\n        "discoveryURL": "URL for the OpenID Provider",\n        "client_id": "client_id given by the provider",\n        "client_secret": "client_secret given by the provider",\n        "server_hostname": "your Actual Server URL (so the provider redirects you to this)",\n        "authMethod": "openid" // or "oauth2"\n    }\n'})}),"\n",(0,o.jsx)(n.p,{children:"If your OpenID provider does not supports discovery, you have to configure each endpoint manually:"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-json",metastring:'title="config.json"',children:'"openId": {\n        "issuer": {\n            "name": "Friendly name for the issuer",\n            "authorization_endpoint": "Provider\'s authorize endpoint",\n            "token_endpoint": "Provider\'s access token endpoint",\n            "userinfo_endpoint": "Provider\'s user info endpoint"\n        },\n        "client_id": "client_id given by the provider",\n        "client_secret": "client_secret given by the provider",\n        "server_hostname": "your Actual Server URL (so the provider redirects you to this)",\n        "authMethod": "openid" // or "oauth2"\n    }\n'})}),"\n",(0,o.jsx)(n.admonition,{type:"tip",children:(0,o.jsxs)(n.p,{children:["To use GitHub as an identity provider can only be achieved with configuration files using ",(0,o.jsx)(n.code,{children:'"authMethod": "oauth2"'}),"."]})}),"\n",(0,o.jsx)(n.h3,{id:"configuration-using-environment-variables",children:"Configuration Using Environment Variables"}),"\n",(0,o.jsx)(n.p,{children:"If your OpenID provider supports discovery, use the following variables:"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"ACTUAL_OPENID_DISCOVERY_URL"}),": URL for the OpenID Provider"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"ACTUAL_OPENID_CLIENT_ID"}),": client_id given by the provider"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"ACTUAL_OPENID_CLIENT_SECRET"}),": client_secret given by the provider"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"ACTUAL_OPENID_SERVER_HOSTNAME"}),": Your Actual Server URL (so the provider redirects you to this)"]}),"\n"]}),"\n",(0,o.jsx)(n.p,{children:"If your OpenId provider does not supports discovery, use the following variables:"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"ACTUAL_OPENID_AUTHORIZATION_ENDPOINT"}),": Provider's authorize endpoint"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"ACTUAL_OPENID_TOKEN_ENDPOINT"}),": Provider's access token endpoint"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"ACTUAL_OPENID_USERINFO_ENDPOINT"}),": Provider's user info endpoint"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"ACTUAL_OPENID_CLIENT_ID"}),": client_id given by the provider"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"ACTUAL_OPENID_CLIENT_SECRET"}),": client_secret given by the provider"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"ACTUAL_OPENID_SERVER_HOSTNAME"}),": Your Actual Server URL (so the provider redirects you to this)"]}),"\n"]}),"\n",(0,o.jsx)(n.h3,{id:"configuring-openid-using-the-ui",children:"Configuring OpenID Using the UI"}),"\n",(0,o.jsxs)(n.p,{children:["Navigate into any Budget file, then in the Settings, click on ",(0,o.jsx)(n.em,{children:"Start using OpenID"})]}),"\n",(0,o.jsx)(n.p,{children:(0,o.jsx)(n.img,{src:i(94934).A+"",width:"560",height:"181"})}),"\n",(0,o.jsxs)(n.p,{children:["Once you click ",(0,o.jsx)(n.em,{children:"Start using OpenID"})," a modal will be presented."]}),"\n",(0,o.jsx)(n.h5,{id:"instructions",children:"Instructions"}),"\n",(0,o.jsx)(n.p,{children:"Fill all the required field for the selected provider."}),"\n",(0,o.jsx)(n.p,{children:(0,o.jsx)(n.img,{alt:"Configuration from options",src:i(80827).A+"",width:"530",height:"462"})}),"\n",(0,o.jsx)(n.p,{children:"Some providers does not require all fields to be filled out."}),"\n",(0,o.jsxs)(n.p,{children:["As an example, the provider ",(0,o.jsx)(n.em,{children:"passwordless.id"})," does not need ",(0,o.jsx)(n.code,{children:"client_secret"}),"."]}),"\n",(0,o.jsx)(n.p,{children:"When all settings are correctly filled out, click the 'OK' button, and you will be redirected to the login page."}),"\n",(0,o.jsx)(n.admonition,{type:"warning",children:(0,o.jsx)(n.p,{children:"There are some basic configuration checks when clicking 'OK', but if you somehow type the wrong information and the data is saved, when you login for the first time using OpenID, you will have a chance to review the settings."})}),"\n",(0,o.jsx)(n.admonition,{type:"tip",children:(0,o.jsxs)(n.p,{children:["When configuring your OpenID provider, be sure to register the following ",(0,o.jsx)(n.strong,{children:"redirect URI"})," with the provider: ",(0,o.jsx)(n.code,{children:"https://<actual.myserver.com>/openid/callback"})]})}),"\n",(0,o.jsx)(n.h4,{id:"tested-providers",children:"Tested Providers"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsx)(n.li,{children:"Auth0"}),"\n",(0,o.jsx)(n.li,{children:"Authentik"}),"\n",(0,o.jsx)(n.li,{children:"GitHub"}),"\n",(0,o.jsx)(n.li,{children:"Google Accounts"}),"\n",(0,o.jsx)(n.li,{children:"Keycloak"}),"\n",(0,o.jsx)(n.li,{children:"Microsoft Entra"}),"\n",(0,o.jsx)(n.li,{children:"Passwordless.id"}),"\n",(0,o.jsx)(n.li,{children:"Pocket ID"}),"\n"]}),"\n",(0,o.jsxs)(n.admonition,{type:"tip",children:[(0,o.jsx)(n.p,{children:"Each provider has different requirements. For example, for Auth0, the URL will be generated by default, but you have to change it with your own details:"}),(0,o.jsx)(n.p,{children:(0,o.jsx)(n.img,{src:i(30343).A+"",width:"465",height:"123"})})]}),"\n",(0,o.jsx)(n.h4,{id:"after-setup",children:"After Setup"}),"\n",(0,o.jsxs)(n.p,{children:["When setup is done, you will be redirected to the ",(0,o.jsx)(n.em,{children:"login"})," page:"]}),"\n",(0,o.jsx)(n.p,{children:(0,o.jsx)(n.img,{src:i(76150).A+"",width:"467",height:"241"})}),"\n",(0,o.jsx)(n.h3,{id:"environment-variables",children:"Environment Variables"}),"\n",(0,o.jsx)(n.h4,{id:"actual_openid_discovery_url",children:(0,o.jsx)(n.code,{children:"ACTUAL_OPENID_DISCOVERY_URL"})}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Purpose:"})," If your OpenID provider supports discovery, this is the URL where discovery metadata can be found.\n",(0,o.jsx)(n.strong,{children:"Example Value:"})," ",(0,o.jsx)(n.code,{children:"https://<openid-provider.com>/.well-known/openid-configuration"})]}),"\n"]}),"\n",(0,o.jsx)(n.h4,{id:"actual_openid_client_id",children:(0,o.jsx)(n.code,{children:"ACTUAL_OPENID_CLIENT_ID"})}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Purpose:"})," The client ID issued by your OpenID provider.\n",(0,o.jsx)(n.strong,{children:"Example Value:"})," ",(0,o.jsx)(n.code,{children:"my-actual-app"})]}),"\n"]}),"\n",(0,o.jsx)(n.h4,{id:"actual_openid_client_secret",children:(0,o.jsx)(n.code,{children:"ACTUAL_OPENID_CLIENT_SECRET"})}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Purpose:"})," The client secret issued by your OpenID provider.\n",(0,o.jsx)(n.strong,{children:"Example Value:"})," ",(0,o.jsx)(n.code,{children:"super-secret-value"})]}),"\n"]}),"\n",(0,o.jsx)(n.h4,{id:"actual_openid_server_hostname",children:(0,o.jsx)(n.code,{children:"ACTUAL_OPENID_SERVER_HOSTNAME"})}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Purpose:"})," The public URL of your Actual Server, which the provider redirects to after authentication.\n",(0,o.jsx)(n.strong,{children:"Example Value:"})," ",(0,o.jsx)(n.code,{children:"https://<actual.myserver.com>"})]}),"\n"]}),"\n",(0,o.jsx)(n.h4,{id:"actual_openid_authorization_endpoint",children:(0,o.jsx)(n.code,{children:"ACTUAL_OPENID_AUTHORIZATION_ENDPOINT"})}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Purpose:"})," Provider's authorization endpoint (for providers that don't support discovery).\n",(0,o.jsx)(n.strong,{children:"Example Value:"})," ",(0,o.jsx)(n.code,{children:"https://<openid-provider.com>/oauth2/authorize"})]}),"\n"]}),"\n",(0,o.jsx)(n.h4,{id:"actual_openid_token_endpoint",children:(0,o.jsx)(n.code,{children:"ACTUAL_OPENID_TOKEN_ENDPOINT"})}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Purpose:"})," Provider's token endpoint (for providers that don't support discovery).\n",(0,o.jsx)(n.strong,{children:"Example Value:"})," ",(0,o.jsx)(n.code,{children:"https://<openid-provider.com>/oauth2/token"})]}),"\n"]}),"\n",(0,o.jsx)(n.h4,{id:"actual_openid_userinfo_endpoint",children:(0,o.jsx)(n.code,{children:"ACTUAL_OPENID_USERINFO_ENDPOINT"})}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Purpose:"})," Provider's user-info endpoint (for providers that don't support discovery).\n",(0,o.jsx)(n.strong,{children:"Example Value:"})," ",(0,o.jsx)(n.code,{children:"https://<openid-provider.com>/oauth2/userinfo"})]}),"\n"]}),"\n",(0,o.jsx)(n.h4,{id:"actual_openid_auth_method",children:(0,o.jsx)(n.code,{children:"ACTUAL_OPENID_AUTH_METHOD"})}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Purpose:"})," Tells the server whether it should use the OpenID (OIDC) or a more general OAuth2 flow.\n",(0,o.jsx)(n.strong,{children:"Possible Values:"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"openid"})," (default)"]}),"\n",(0,o.jsx)(n.li,{children:(0,o.jsx)(n.code,{children:"oauth2"})}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,o.jsx)(n.admonition,{type:"tip",children:(0,o.jsxs)(n.p,{children:["Use ",(0,o.jsx)(n.code,{children:"oauth2"})," for providers like GitHub that don't fully support OpenID discovery."]})}),"\n",(0,o.jsx)(n.h4,{id:"actual_openid_enforce",children:(0,o.jsx)(n.code,{children:"ACTUAL_OPENID_ENFORCE"})}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Purpose:"})," Forces OpenID/OAuth2 authentication as the only allowed login method when set to ",(0,o.jsx)(n.code,{children:"true"}),".\n",(0,o.jsx)(n.strong,{children:"Example Value:"})," ",(0,o.jsx)(n.code,{children:"true"})," or ",(0,o.jsx)(n.code,{children:"false"})," (default is ",(0,o.jsx)(n.code,{children:"false"}),")"]}),"\n"]}),"\n",(0,o.jsx)(n.h4,{id:"actual_token_expiration",children:(0,o.jsx)(n.code,{children:"ACTUAL_TOKEN_EXPIRATION"})}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Purpose:"})," Controls how access tokens expire.\n",(0,o.jsx)(n.strong,{children:"Possible Values:"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:'"never"'})," (tokens never expire - ",(0,o.jsx)(n.strong,{children:"current default"}),")"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:'"openid-provider"'})," (tokens follow the expiration time from the OpenID provider)"]}),"\n",(0,o.jsxs)(n.li,{children:["A numeric value in seconds (e.g., ",(0,o.jsx)(n.code,{children:"3600"})," for 1 hour)"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,o.jsx)(n.admonition,{type:"tip",children:(0,o.jsxs)(n.p,{children:["Configuring the OpenID provider from options supports discovery; otherwise, use ",(0,o.jsx)(n.a,{href:"oauth-auth#config-using-configuration-file",children:"file configuration"})]})})]})}function a(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,o.jsx)(n,{...e,children:(0,o.jsx)(h,{...e})}):h(e)}},30343:(e,n,i)=>{i.d(n,{A:()=>r});const r=i.p+"assets/images/provider-requirement-30b501a42b0715a9a9b7b1fb501edf09.png"},71184:(e,n,i)=>{i.d(n,{R:()=>t,x:()=>d});var r=i(14041);const o={},s=r.createContext(o);function t(e){const n=r.useContext(s);return r.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function d(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:t(e.components),r.createElement(s.Provider,{value:n},e.children)}},76150:(e,n,i)=>{i.d(n,{A:()=>r});const r=i.p+"assets/images/first-login-e1769f2744b166f6f94895945a764b92.png"},80827:(e,n,i)=>{i.d(n,{A:()=>r});const r=i.p+"assets/images/modal-919ebc0ad11202e03ab74ffb1ea70965.png"},94934:(e,n,i)=>{i.d(n,{A:()=>r});const r=i.p+"assets/images/start-using-options-7c384cfe2527aa607f67422cde5de948.png"}}]);