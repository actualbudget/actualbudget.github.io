"use strict";(globalThis.webpackChunkdocs=globalThis.webpackChunkdocs||[]).push([[9502],{20407:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>c,contentTitle:()=>i,default:()=>h,frontMatter:()=>o,metadata:()=>r,toc:()=>l});const r=JSON.parse('{"id":"config/reverse-proxies","title":"Using a Reverse Proxy","description":"If you want to expose Actual to the internet, you should hide it behind a reverse proxy with SSL enabled.","source":"@site/docs/config/reverse-proxies.md","sourceDirName":"config","slug":"/config/reverse-proxies","permalink":"/docs/config/reverse-proxies","draft":false,"unlisted":false,"editUrl":"https://github.com/actualbudget/actual/tree/master/packages/docs/docs/config/reverse-proxies.md","tags":[],"version":"current","frontMatter":{"title":"Using a Reverse Proxy"},"sidebar":"docs","previous":{"title":"Activating HTTPS","permalink":"/docs/config/https"},"next":{"title":"Authenticating With an OpenID Provider","permalink":"/docs/config/oauth-auth"}}');var s=t(31085),a=t(71184);const o={title:"Using a Reverse Proxy"},i="Using a Reverse Proxy",c={},l=[{value:"CADDY",id:"caddy",level:2},{value:"Traefik",id:"traefik",level:2},{value:"NGINX",id:"nginx",level:2},{value:"Apache httpd",id:"apache-httpd",level:2},{value:"Ngrok",id:"ngrok",level:2}];function d(e){const n={a:"a",admonition:"admonition",code:"code",em:"em",h1:"h1",h2:"h2",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,a.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"using-a-reverse-proxy",children:"Using a Reverse Proxy"})}),"\n",(0,s.jsx)(n.p,{children:"If you want to expose Actual to the internet, you should hide it behind a reverse proxy with SSL enabled.\nThere are a series of tools that can be used for this purpose. This configuration page is dynamic, so that new tools and their configuration can be added continuously."}),"\n",(0,s.jsxs)(n.p,{children:["In our examples, the Actual Server should be published under the domain ",(0,s.jsx)(n.strong,{children:"budget.example.org"}),"."]}),"\n",(0,s.jsx)(n.admonition,{type:"note",children:(0,s.jsxs)(n.p,{children:["The ",(0,s.jsx)(n.strong,{children:"basic configurations"})," provided here are only suggestions for implementing a reverse proxy configuration. Additional security mechanisms should then be activated/implemented for the tool selected in each case."]})}),"\n",(0,s.jsx)(n.h2,{id:"caddy",children:"CADDY"}),"\n",(0,s.jsxs)(n.p,{children:["Below is an example ",(0,s.jsx)(n.code,{children:"Caddyfile"})," that you can use to configure Caddy and Actual Server using Docker. Caddy is an easy reverse proxy to use since it automatically obtains and renews SSL certificates for you."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",metastring:'title="docker-compose.yml"',children:'services:\n  caddy:\n    image: caddy:alpine\n    container_name: caddy\n    restart: unless-stopped\n    volumes:\n      - ./Caddyfile:/etc/caddy/Caddyfile:ro\n      - ./caddy/data:/data\n      - ./caddy/config:/config\n    ports:\n      - "80:80"\n      - "443:443"\n\n  actual-server:\n    image: actualbudget/actual-server:latest\n    container_name: actual_server\n    restart: unless-stopped\n    volumes:\n      - ./actual-data:/data\n'})}),"\n",(0,s.jsx)(n.p,{children:"Caddyfile:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"budget.example.org {\n    encode gzip zstd\n    reverse_proxy actual_server:5006\n}\n"})}),"\n",(0,s.jsx)(n.h2,{id:"traefik",children:"Traefik"}),"\n",(0,s.jsxs)(n.p,{children:["Our example shows a working configuration for Traefik and Actual Server using Docker - as documented in ",(0,s.jsx)(n.a,{href:"/docs/install/docker",children:"Install Actual/Docker"})]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",metastring:'title="docker-compose.yml"',children:'services:\n  traefik:\n    image: traefik:latest\n    restart: unless-stopped\n    ports:\n      - "80:80"\n      - "443:443"\n    volumes:\n      - "./traefik.yaml:/etc/traefik/traefik.yaml"\n      - "./traefik/data:/data"\n      - "/var/run/docker.sock:/var/run/docker.sock"\n\n  actual-server:\n    image: actualbudget/actual-server:latest\n    restart: unless-stopped\n    labels:\n      - "traefik.enable=true"\n      - "traefik.http.routers.actual-server.rule=Host(`budget.example.org`)"\n      - "traefik.http.routers.actual-server.entrypoints=websecure"\n      - "traefik.http.services.actual-server.loadbalancer.server.port=5006"\n    volumes:\n      - ./actual-data:/data\n'})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",metastring:'title="traefik.yaml"',children:'entryPoints:\n  web:\n    address: ":80"\n    http:\n      redirections:\n        entryPoint:\n          to: websecure\n          scheme: https\n          permanent: true\n  websecure:\n    address: ":443"\n    http:\n      tls:\n        certResolver: le\n\nproviders:\n  docker: {}\n\ncertificatesResolvers:\n  letsencrypt:\n    acme:\n      email: you@example.com\n      storage: /data/letsencrypt.json\n      httpChallenge:\n        entryPoint: web\n'})}),"\n",(0,s.jsxs)(n.p,{children:["Please refer to the ",(0,s.jsx)(n.a,{href:"https://doc.traefik.io/traefik/user-guides/docker-compose/basic-example/",children:"official documentation"})," for further details."]}),"\n",(0,s.jsx)(n.h2,{id:"nginx",children:"NGINX"}),"\n",(0,s.jsxs)(n.p,{children:["The SSL certificate is issued by Let's Encrypt. The ",(0,s.jsx)(n.a,{href:"https://certbot.eff.org/instructions",children:"Certbot"})," tool provides options for automatic updating upon expiration.\nAt the very least you will need to adapt ",(0,s.jsx)(n.code,{children:"server_name"})," and the ",(0,s.jsx)(n.code,{children:"ssl_certificate/ssl_certificate_key"})," paths to match your setup.\nPlease refer to their ",(0,s.jsx)(n.a,{href:"https://nginx.org/en/docs/",children:"official documentation"})," for further details."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-nginx",metastring:'title="NGINX Example Config"',children:"server {\n  listen 443 ssl;\n  listen [::]:443 ssl;\n  server_name budget.*;\n\n  include /config/nginx/ssl.conf;\n  client_max_body_size 0;\n\n  # With SSL via Let's Encrypt\n  ssl_certificate /etc/letsencrypt/live/example.com/fullchain.pem; # managed by Certbot\n  ssl_certificate_key /etc/letsencrypt/live/example.com/privkey.pem; # managed by Certbot\n  include /etc/letsencrypt/options-ssl-nginx.conf; # managed by Certbot\n  ssl_dhparam /etc/letsencrypt/ssl-dhparams.pem; # managed by Certbot\n\n  location / {\n    include /config/nginx/proxy.conf;\n    include /config/nginx/resolver.conf;\n\n    proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n    proxy_set_header Host $host;\n\n    set $upstream_app actual-server;\n    set $upstream_port 5006;\n    set $upstream_proto http;\n    proxy_pass $upstream_proto://$upstream_app:$upstream_port;\n  }\n}\n"})}),"\n",(0,s.jsx)(n.h2,{id:"apache-httpd",children:"Apache httpd"}),"\n",(0,s.jsxs)(n.p,{children:["Apache HTTP server can serve as a reverse proxy using ",(0,s.jsx)(n.a,{href:"https://httpd.apache.org/docs/2.4/vhosts/examples.html",children:"VirtualHosts"}),". This snippet would be added to the bottom of httpd.conf or in a new site.conf in the sites-available folder. Certbot is supported on httpd but is not used in this example"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:'<VirtualHost *:443>\n  ServerName budget.example.com\n  SSLProxyCheckPeerName off\n\tSSLProxyVerify none\n  SSLEngine on\n  SSLProxyEngine on\n  SSLCertificateFile /etc/letsencrypt/live/example.com/fullchain.pem\n  SSLCertificateKeyFile /etc/letsencrypt/live/example.com/privkey.pem\n\n  ProxyPreserveHost On\n  RequestHeader set X-Forwarded-Proto "https"\n  RequestHeader set X-Forwarded-Port "443"\n\n  # IP in the following lines can be a remote host, or a container IP\n  ProxyPass / http://127.0.0.1:5006/\n  ProxyPassReverse / http://127.0.0.1:5006/\n</VirtualHost>\n'})}),"\n",(0,s.jsx)(n.h2,{id:"ngrok",children:"Ngrok"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.a,{href:"https://ngrok.com/",children:"Ngrok"})," offers a reverse proxy and a static domain for ",(0,s.jsx)(n.a,{href:"https://ngrok.com/docs/pricing-limits/free-plan-limits/",children:"free"}),". You'll need to create an account with them and follow the instructions on their ",(0,s.jsx)(n.a,{href:"https://dashboard.ngrok.com/",children:"dashboard"})," getting started section. The instructions will guide you through configuring ngrok."]}),"\n",(0,s.jsxs)(n.p,{children:["Creating a free Ngrok domain is very simple: just navigate to the Domains section of the site. For more information, check out the ",(0,s.jsx)(n.a,{href:"https://ngrok.com/docs/guides/other-guides/how-to-set-up-a-custom-domain/",children:"custom domain docs"}),"."]}),"\n",(0,s.jsx)(n.p,{children:"Once that's all done, you can expose Actual to the internet with your custom domain and free SSL with a simple command:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"ngrok http --url=your-custom-domain.ngrok-free.app 5006\n"})}),"\n",(0,s.jsx)(n.p,{children:"If running Actual on your PC, you may find it helpful to run this command when your computer starts up. There are many ways to do this. The below is not a complete list:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["On Windows, you can use the ",(0,s.jsx)(n.a,{href:"https://www.technipages.com/scheduled-task-windows/",children:"Task Scheduler"})]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Create a ",(0,s.jsx)(n.em,{children:"Basic Task"}),", give it a name then set the trigger to ",(0,s.jsx)(n.em,{children:"At system startup"})]}),"\n",(0,s.jsxs)(n.li,{children:["Under ",(0,s.jsx)(n.em,{children:"Action"}),", select the program as ngrok.exe, and add arguments ",(0,s.jsx)(n.code,{children:"http --url=your-custom-domain.ngrok-free.app 5006"}),"."]}),"\n",(0,s.jsxs)(n.li,{children:["Once complete, you can choose to run this silently in the background by navigating to ",(0,s.jsx)(n.em,{children:"properties"}),", selecting ",(0,s.jsx)(n.em,{children:"Run whether user is logged on or not"}),", and ticking the ",(0,s.jsx)(n.em,{children:"Hidden"})," box."]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["On Linux, you can use ",(0,s.jsx)(n.a,{href:"https://systemd.io/",children:"systemd"})]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["Navigate to the directory: ",(0,s.jsx)(n.code,{children:"/etc/systemd/system/"})," and create a service file ",(0,s.jsx)(n.code,{children:"expose-actual-server.service"})]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"Add the following content (and change to suit your needs):"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"[Unit]\nDescription=Run my Bash script at startup\nAfter=network.target\n\n[Service]\nExecStart=ngrok http --url=<your-custom-domain>.ngrok-free.app 5006\nRestart=always\nUser=<your user>\n\n[Install]\nWantedBy=multi-user.target\n"})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["Enable the service with ",(0,s.jsx)(n.code,{children:"sudo systemctl enable expose-actual-server.service"})]}),"\n"]}),"\n"]}),"\n"]}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,a.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(d,{...e})}):d(e)}},71184:(e,n,t)=>{t.d(n,{R:()=>o,x:()=>i});var r=t(14041);const s={},a=r.createContext(s);function o(e){const n=r.useContext(a);return r.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function i(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:o(e.components),r.createElement(a.Provider,{value:n},e.children)}}}]);