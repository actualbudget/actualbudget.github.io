"use strict";(globalThis.webpackChunkdocs=globalThis.webpackChunkdocs||[]).push([[9615],{52370:(e,d,r)=>{r.d(d,{A:()=>s});const s=r.p+"assets/images/add-formula-card-9ab340894ff3431f758bb544ab9830de.png"},58757:(e,d,r)=>{r.d(d,{A:()=>s});const s=r.p+"assets/images/rule-formula-toggle-101e9509e80f06f1c28bae518bb94b68.png"},67999:(e,d,r)=>{r.r(d),r.d(d,{assets:()=>t,contentTitle:()=>i,default:()=>j,frontMatter:()=>c,metadata:()=>s,toc:()=>h});const s=JSON.parse('{"id":"experimental/formulas","title":"Excel Formula Mode (Formula cards & Rule formulas)","description":"This is an experimental feature. That means we\u2019re still working on finishing it. There may be bugs, missing functionality or incomplete documentation, and we may decide to remove the feature in a future release. If you have any feedback, please comment on this feedback issue or post a message in the Discord.","source":"@site/docs/experimental/formulas.md","sourceDirName":"experimental","slug":"/experimental/formulas","permalink":"/docs/experimental/formulas","draft":false,"unlisted":false,"editUrl":"https://github.com/actualbudget/actual/tree/master/packages/docs/docs/experimental/formulas.md","tags":[],"version":"current","frontMatter":{},"sidebar":"docs","previous":{"title":"Rule Action Templating","permalink":"/docs/experimental/rule-templating"},"next":{"title":"Pluggy.ai Setup","permalink":"/docs/experimental/pluggyai"}}');var n=r(31085),l=r(71184);const c={},i="Excel Formula Mode (Formula cards & Rule formulas)",t={},h=[{value:"Enable the feature",id:"enable-the-feature",level:2},{value:"Formula cards",id:"formula-cards",level:2},{value:"Add a Formula card",id:"add-a-formula-card",level:3},{value:"Write a formula",id:"write-a-formula",level:3},{value:"Function reference (autocomplete)",id:"function-reference-autocomplete",level:2},{value:"Use queries with <code>QUERY(&quot;name&quot;)</code> and <code>QUERY_COUNT(&quot;name&quot;)</code>",id:"use-queries-with-queryname-and-query_countname",level:3},{value:"Define a query",id:"define-a-query",level:3},{value:"Optional: conditional color",id:"optional-conditional-color",level:3},{value:"Rule formulas",id:"rule-formulas",level:2},{value:"Where to find the formula toggle",id:"where-to-find-the-formula-toggle",level:3},{value:"Available variables",id:"available-variables",level:3},{value:"Result types",id:"result-types",level:3}];function x(e){const d={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",img:"img",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,l.R)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(d.header,{children:(0,n.jsx)(d.h1,{id:"excel-formula-mode-formula-cards--rule-formulas",children:"Excel Formula Mode (Formula cards & Rule formulas)"})}),"\n",(0,n.jsx)(d.admonition,{type:"warning",children:(0,n.jsxs)(d.p,{children:["This is an ",(0,n.jsx)(d.strong,{children:"experimental feature"}),". That means we\u2019re still working on finishing it. There may be bugs, missing functionality or incomplete documentation, and we may decide to remove the feature in a future release. If you have any feedback, please comment on ",(0,n.jsx)(d.a,{href:"https://github.com/actualbudget/actual/issues/5949",children:"this feedback issue"})," or post a message in the Discord."]})}),"\n",(0,n.jsx)(d.admonition,{type:"warning",children:(0,n.jsxs)(d.p,{children:["All functionality described here may not be available in the latest stable release. See ",(0,n.jsx)(d.a,{href:"/docs/experimental/",children:"Experimental Features"})," for instructions to enable experimental features. Use the ",(0,n.jsx)(d.code,{children:"edge"})," images for the latest implementation."]})}),"\n",(0,n.jsx)(d.p,{children:"Excel formula mode adds two related features:"}),"\n",(0,n.jsxs)(d.ul,{children:["\n",(0,n.jsxs)(d.li,{children:[(0,n.jsx)(d.strong,{children:"Formula cards"}),": a dashboard/report card that evaluates an Excel-style formula, including totals from custom queries."]}),"\n",(0,n.jsxs)(d.li,{children:[(0,n.jsx)(d.strong,{children:"Rule formulas"}),": in the Rules editor, some \u201cset field\u201d actions can be driven by a formula instead of a fixed value."]}),"\n"]}),"\n",(0,n.jsxs)(d.p,{children:["Under the hood, Actual evaluates formulas using ",(0,n.jsx)(d.a,{href:"https://hyperformula.handsontable.com/",children:"HyperFormula"}),". Formulas ",(0,n.jsxs)(d.strong,{children:["must start with ",(0,n.jsx)(d.code,{children:"="})]}),"."]}),"\n",(0,n.jsx)(d.h2,{id:"enable-the-feature",children:"Enable the feature"}),"\n",(0,n.jsxs)(d.p,{children:["Go to ",(0,n.jsx)(d.code,{children:"Settings -> Show advanced settings -> Experimental features"})," and enable:"]}),"\n",(0,n.jsxs)(d.ul,{children:["\n",(0,n.jsx)(d.li,{children:(0,n.jsx)(d.strong,{children:"Excel formula mode (Formula cards & Rule formulas)"})}),"\n"]}),"\n",(0,n.jsx)(d.p,{children:(0,n.jsx)(d.img,{alt:"Placeholder: enable Excel formula mode toggle",src:r(69673).A+"",width:"837",height:"466"})}),"\n",(0,n.jsx)(d.h2,{id:"formula-cards",children:"Formula cards"}),"\n",(0,n.jsx)(d.h3,{id:"add-a-formula-card",children:"Add a Formula card"}),"\n",(0,n.jsxs)(d.ol,{children:["\n",(0,n.jsxs)(d.li,{children:["Go to ",(0,n.jsx)(d.strong,{children:"Reports"})]}),"\n",(0,n.jsxs)(d.li,{children:["Click ",(0,n.jsx)(d.strong,{children:"Edit dashboard"})]}),"\n",(0,n.jsxs)(d.li,{children:["Click ",(0,n.jsx)(d.strong,{children:"Add widget"})]}),"\n",(0,n.jsxs)(d.li,{children:["Choose ",(0,n.jsx)(d.strong,{children:"Formula card"})]}),"\n"]}),"\n",(0,n.jsx)(d.p,{children:"Click the card to open the editor (where you can save the widget)."}),"\n",(0,n.jsx)(d.p,{children:(0,n.jsx)(d.img,{alt:"Placeholder: add Formula card from Reports dashboard",src:r(52370).A+"",width:"427",height:"502"})}),"\n",(0,n.jsx)(d.h3,{id:"write-a-formula",children:"Write a formula"}),"\n",(0,n.jsxs)(d.ul,{children:["\n",(0,n.jsxs)(d.li,{children:[(0,n.jsxs)(d.strong,{children:["Start with ",(0,n.jsx)(d.code,{children:"="})]})," (example: ",(0,n.jsx)(d.code,{children:"=SUM(1, 2, 3)"}),")"]}),"\n",(0,n.jsx)(d.li,{children:"You can use typical Excel-style functions (autocomplete and hover help are built into the editor)."}),"\n"]}),"\n",(0,n.jsx)(d.h2,{id:"function-reference-autocomplete",children:"Function reference (autocomplete)"}),"\n",(0,n.jsxs)(d.p,{children:["This list documents the functions that appear in the in-app ",(0,n.jsx)(d.strong,{children:"autocomplete/hover popover"})," for formulas."]}),"\n",(0,n.jsx)(d.admonition,{type:"tip",children:(0,n.jsxs)(d.p,{children:["If a function isn\u2019t listed here, it still might work. Actual uses HyperFormula under the hood, so you can also refer to ",(0,n.jsx)(d.a,{href:"https://hyperformula.handsontable.com/guide/built-in-functions.html",children:"HyperFormula\u2019s built-in functions list"}),"."]})}),"\n",(0,n.jsxs)(d.table,{children:[(0,n.jsx)(d.thead,{children:(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.th,{children:"Function"}),(0,n.jsx)(d.th,{children:"Available in"}),(0,n.jsx)(d.th,{children:"Description"}),(0,n.jsx)(d.th,{children:"Syntax example"}),(0,n.jsx)(d.th,{children:"Optional params"})]})}),(0,n.jsxs)(d.tbody,{children:[(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"ABS"})}),(0,n.jsx)(d.td,{children:"Query, Rules"}),(0,n.jsx)(d.td,{children:"Returns the absolute value of a number."}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"=ABS(-42)"})}),(0,n.jsx)(d.td,{children:"\u2014"})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"AND"})}),(0,n.jsx)(d.td,{children:"Query, Rules"}),(0,n.jsx)(d.td,{children:"Returns TRUE if all arguments are TRUE."}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"=AND(1=1, 2=2)"})}),(0,n.jsx)(d.td,{children:"Accepts more than 2 conditions"})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"AVERAGE"})}),(0,n.jsx)(d.td,{children:"Query"}),(0,n.jsx)(d.td,{children:"Returns the average of all numbers in a range."}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"=AVERAGE(1, 2, 3)"})}),(0,n.jsx)(d.td,{children:"Accepts more than 2 values"})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"AVERAGEA"})}),(0,n.jsx)(d.td,{children:"Query"}),(0,n.jsx)(d.td,{children:"Returns the average, including text and logical values."}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:'=AVERAGEA(1, TRUE, "2")'})}),(0,n.jsx)(d.td,{children:"Accepts more than 2 values"})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"CEILING"})}),(0,n.jsx)(d.td,{children:"Query, Rules"}),(0,n.jsx)(d.td,{children:"Rounds up to nearest multiple of significance."}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"=CEILING(10.2, 1)"})}),(0,n.jsx)(d.td,{children:"\u2014"})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"CHAR"})}),(0,n.jsx)(d.td,{children:"Query, Rules"}),(0,n.jsx)(d.td,{children:"Converts number to character."}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"=CHAR(65)"})}),(0,n.jsx)(d.td,{children:"\u2014"})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"CHOOSE"})}),(0,n.jsx)(d.td,{children:"Query"}),(0,n.jsx)(d.td,{children:"Returns value from list based on index."}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:'=CHOOSE(2, "A", "B", "C")'})}),(0,n.jsx)(d.td,{children:"Accepts more than 2 values"})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"CLEAN"})}),(0,n.jsx)(d.td,{children:"Rules"}),(0,n.jsx)(d.td,{children:"Removes non-printable characters from text."}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"=CLEAN(notes)"})}),(0,n.jsx)(d.td,{children:"\u2014"})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"CODE"})}),(0,n.jsx)(d.td,{children:"Query, Rules"}),(0,n.jsx)(d.td,{children:"Returns numeric code for first character."}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:'=CODE("A")'})}),(0,n.jsx)(d.td,{children:"\u2014"})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"CONCATENATE"})}),(0,n.jsx)(d.td,{children:"Query, Rules"}),(0,n.jsx)(d.td,{children:"Combines several text strings into one."}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:'=CONCATENATE("Paid ", payee_name)'})}),(0,n.jsx)(d.td,{children:"Accepts more than 2 texts"})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"COS"})}),(0,n.jsx)(d.td,{children:"Query"}),(0,n.jsx)(d.td,{children:"Returns the cosine of an angle."}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"=COS(1)"})}),(0,n.jsx)(d.td,{children:"\u2014"})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"COUNT"})}),(0,n.jsx)(d.td,{children:"Query"}),(0,n.jsx)(d.td,{children:"Counts the number of numeric values."}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:'=COUNT(1, 2, "x")'})}),(0,n.jsx)(d.td,{children:"Accepts more than 2 values"})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"COUNTA"})}),(0,n.jsx)(d.td,{children:"Query"}),(0,n.jsx)(d.td,{children:"Counts non-empty values."}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:'=COUNTA(1, "", "x")'})}),(0,n.jsx)(d.td,{children:"Accepts more than 2 values"})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"COUNTBLANK"})}),(0,n.jsx)(d.td,{children:"Query"}),(0,n.jsx)(d.td,{children:"Counts empty cells."}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"=COUNTBLANK(A1:A10)"})}),(0,n.jsx)(d.td,{children:"\u2014"})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"COUNTIF"})}),(0,n.jsx)(d.td,{children:"Query"}),(0,n.jsx)(d.td,{children:"Counts cells that meet a criteria."}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:'=COUNTIF(A1:A10, ">0")'})}),(0,n.jsx)(d.td,{children:"\u2014"})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"COUNTIFS"})}),(0,n.jsx)(d.td,{children:"Query"}),(0,n.jsx)(d.td,{children:"Counts cells that meet multiple criteria."}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:'=COUNTIFS(A1:A10, ">0", B1:B10, "<=5")'})}),(0,n.jsxs)(d.td,{children:["Repeat ",(0,n.jsx)(d.code,{children:"(range, criteria)"})," pairs"]})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"DATE"})}),(0,n.jsx)(d.td,{children:"Query, Rules"}),(0,n.jsx)(d.td,{children:"Returns date as number of days since null date."}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"=DATE(2025, 12, 16)"})}),(0,n.jsx)(d.td,{children:"\u2014"})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"DATEDIF"})}),(0,n.jsx)(d.td,{children:"Query, Rules"}),(0,n.jsx)(d.td,{children:"Calculates distance between dates."}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:'=DATEDIF("2025-01-01", "2025-12-31", "D")'})}),(0,n.jsx)(d.td,{children:"\u2014"})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"DATEVALUE"})}),(0,n.jsx)(d.td,{children:"Rules"}),(0,n.jsx)(d.td,{children:"Parses a date string and returns it as a number."}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:'=DATEVALUE("2025-12-16")'})}),(0,n.jsx)(d.td,{children:"\u2014"})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"DAY"})}),(0,n.jsx)(d.td,{children:"Query, Rules"}),(0,n.jsx)(d.td,{children:"Returns the day from a date."}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"=DAY(date)"})}),(0,n.jsx)(d.td,{children:"\u2014"})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"DAYS"})}),(0,n.jsx)(d.td,{children:"Query, Rules"}),(0,n.jsx)(d.td,{children:"Calculates difference between dates in days."}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:'=DAYS("2025-12-31", "2025-12-01")'})}),(0,n.jsx)(d.td,{children:"\u2014"})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"EDATE"})}),(0,n.jsx)(d.td,{children:"Query, Rules"}),(0,n.jsx)(d.td,{children:"Returns date shifted by specified months."}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"=EDATE(date, 1)"})}),(0,n.jsx)(d.td,{children:"\u2014"})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"EOMONTH"})}),(0,n.jsx)(d.td,{children:"Query, Rules"}),(0,n.jsx)(d.td,{children:"Returns last day of month after specified months."}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"=EOMONTH(date, 0)"})}),(0,n.jsx)(d.td,{children:"\u2014"})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"EXACT"})}),(0,n.jsx)(d.td,{children:"Query, Rules"}),(0,n.jsx)(d.td,{children:"Returns TRUE if texts are exactly the same."}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:'=EXACT("A", "a")'})}),(0,n.jsx)(d.td,{children:"\u2014"})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"EXP"})}),(0,n.jsx)(d.td,{children:"Query"}),(0,n.jsx)(d.td,{children:"Returns e raised to the power of number."}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"=EXP(1)"})}),(0,n.jsx)(d.td,{children:"\u2014"})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"FALSE"})}),(0,n.jsx)(d.td,{children:"Query, Rules"}),(0,n.jsx)(d.td,{children:"Returns the logical value FALSE."}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"=FALSE()"})}),(0,n.jsx)(d.td,{children:"\u2014"})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"FIND"})}),(0,n.jsx)(d.td,{children:"Query, Rules"}),(0,n.jsx)(d.td,{children:"Finds text within text (case-sensitive)."}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:'=FIND("foo", notes)'})}),(0,n.jsx)(d.td,{children:"\u2014"})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"FLOOR"})}),(0,n.jsx)(d.td,{children:"Query, Rules"}),(0,n.jsx)(d.td,{children:"Rounds down to nearest multiple of significance."}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"=FLOOR(10.8, 1)"})}),(0,n.jsx)(d.td,{children:"\u2014"})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"FV"})}),(0,n.jsx)(d.td,{children:"Query"}),(0,n.jsx)(d.td,{children:"Calculates future value of investment."}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"=FV(0.05/12, 12, -100)"})}),(0,n.jsx)(d.td,{children:"\u2014"})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"HLOOKUP"})}),(0,n.jsx)(d.td,{children:"Query"}),(0,n.jsx)(d.td,{children:"Searches horizontally in first row and returns value."}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:'=HLOOKUP("key", A1:D10, 2, TRUE)'})}),(0,n.jsx)(d.td,{children:"\u2014"})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"IF"})}),(0,n.jsx)(d.td,{children:"Query, Rules"}),(0,n.jsx)(d.td,{children:"Returns one value if condition is TRUE, another if FALSE."}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:'=IF(amount<0, "Expense", "Income")'})}),(0,n.jsx)(d.td,{children:"\u2014"})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"IFERROR"})}),(0,n.jsx)(d.td,{children:"Query, Rules"}),(0,n.jsx)(d.td,{children:"Returns value if no error, otherwise returns alternative."}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"=IFERROR(1/0, 0)"})}),(0,n.jsx)(d.td,{children:"\u2014"})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"IFNA"})}),(0,n.jsx)(d.td,{children:"Query, Rules"}),(0,n.jsx)(d.td,{children:"Returns value if not #N/A error, otherwise returns alternative."}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:'=IFNA(VLOOKUP("x", A1:B10, 2, FALSE), 0)'})}),(0,n.jsx)(d.td,{children:"\u2014"})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"IFS"})}),(0,n.jsx)(d.td,{children:"Query, Rules"}),(0,n.jsx)(d.td,{children:"Checks multiple conditions and returns corresponding values."}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:'=IFS(amount<0, "Expense", amount>0, "Income")'})}),(0,n.jsxs)(d.td,{children:["Repeat ",(0,n.jsx)(d.code,{children:"(condition, value)"})," pairs"]})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"INDEX"})}),(0,n.jsx)(d.td,{children:"Query"}),(0,n.jsx)(d.td,{children:"Returns value at specified row and column."}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"=INDEX(A1:C10, 2, 3)"})}),(0,n.jsx)(d.td,{children:"\u2014"})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"INTEGER_TO_AMOUNT"})}),(0,n.jsx)(d.td,{children:"Query, Rules"}),(0,n.jsx)(d.td,{children:"Converts integer amount to decimal amount (e.g., 1234 -> 12.34)."}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"=INTEGER_TO_AMOUNT(amount, 2)"})}),(0,n.jsxs)(d.td,{children:[(0,n.jsx)(d.code,{children:"decimal_places"})," (default: 2)"]})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"INT"})}),(0,n.jsx)(d.td,{children:"Rules"}),(0,n.jsx)(d.td,{children:"Rounds down to nearest integer."}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"=INT(10.9)"})}),(0,n.jsx)(d.td,{children:"\u2014"})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"IRR"})}),(0,n.jsx)(d.td,{children:"Query"}),(0,n.jsx)(d.td,{children:"Calculates internal rate of return."}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"=IRR(A1:A12)"})}),(0,n.jsx)(d.td,{children:"\u2014"})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"ISEVEN"})}),(0,n.jsx)(d.td,{children:"Rules"}),(0,n.jsx)(d.td,{children:"Returns TRUE if number is even."}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"=ISEVEN(10)"})}),(0,n.jsx)(d.td,{children:"\u2014"})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"ISODD"})}),(0,n.jsx)(d.td,{children:"Rules"}),(0,n.jsx)(d.td,{children:"Returns TRUE if number is odd."}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"=ISODD(11)"})}),(0,n.jsx)(d.td,{children:"\u2014"})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"ISBLANK"})}),(0,n.jsx)(d.td,{children:"Query, Rules"}),(0,n.jsx)(d.td,{children:"Returns TRUE if value is blank."}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"=ISBLANK(notes)"})}),(0,n.jsx)(d.td,{children:"\u2014"})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"ISERROR"})}),(0,n.jsx)(d.td,{children:"Query, Rules"}),(0,n.jsx)(d.td,{children:"Returns TRUE if value is any error."}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"=ISERROR(1/0)"})}),(0,n.jsx)(d.td,{children:"\u2014"})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"ISLOGICAL"})}),(0,n.jsx)(d.td,{children:"Query, Rules"}),(0,n.jsx)(d.td,{children:"Returns TRUE if value is logical (TRUE/FALSE)."}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"=ISLOGICAL(TRUE())"})}),(0,n.jsx)(d.td,{children:"\u2014"})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"ISNA"})}),(0,n.jsx)(d.td,{children:"Query, Rules"}),(0,n.jsx)(d.td,{children:"Returns TRUE if value is #N/A error."}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"=ISNA(NA())"})}),(0,n.jsx)(d.td,{children:"\u2014"})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"ISNUMBER"})}),(0,n.jsx)(d.td,{children:"Query, Rules"}),(0,n.jsx)(d.td,{children:"Returns TRUE if value is a number."}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"=ISNUMBER(amount)"})}),(0,n.jsx)(d.td,{children:"\u2014"})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"ISOWEEKNUM"})}),(0,n.jsx)(d.td,{children:"Rules"}),(0,n.jsx)(d.td,{children:"Returns ISO week number."}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"=ISOWEEKNUM(date)"})}),(0,n.jsx)(d.td,{children:"\u2014"})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"ISREF"})}),(0,n.jsx)(d.td,{children:"Query, Rules"}),(0,n.jsx)(d.td,{children:"Returns TRUE if value is a reference."}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"=ISREF(A1)"})}),(0,n.jsx)(d.td,{children:"\u2014"})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"ISTEXT"})}),(0,n.jsx)(d.td,{children:"Query, Rules"}),(0,n.jsx)(d.td,{children:"Returns TRUE if value is text."}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"=ISTEXT(notes)"})}),(0,n.jsx)(d.td,{children:"\u2014"})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"LEFT"})}),(0,n.jsx)(d.td,{children:"Query, Rules"}),(0,n.jsx)(d.td,{children:"Returns leftmost characters from text."}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"=LEFT(imported_payee, 10)"})}),(0,n.jsx)(d.td,{children:"\u2014"})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"LEN"})}),(0,n.jsx)(d.td,{children:"Query, Rules"}),(0,n.jsx)(d.td,{children:"Returns length of text."}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"=LEN(notes)"})}),(0,n.jsx)(d.td,{children:"\u2014"})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"LN"})}),(0,n.jsx)(d.td,{children:"Query"}),(0,n.jsx)(d.td,{children:"Returns the natural logarithm."}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"=LN(10)"})}),(0,n.jsx)(d.td,{children:"\u2014"})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"LOG"})}),(0,n.jsx)(d.td,{children:"Query"}),(0,n.jsx)(d.td,{children:"Returns the logarithm to specified base."}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"=LOG(100, 10)"})}),(0,n.jsx)(d.td,{children:"\u2014"})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"LOG10"})}),(0,n.jsx)(d.td,{children:"Query"}),(0,n.jsx)(d.td,{children:"Returns the base-10 logarithm."}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"=LOG10(1000)"})}),(0,n.jsx)(d.td,{children:"\u2014"})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"LOOKUP"})}),(0,n.jsx)(d.td,{children:"Query"}),(0,n.jsx)(d.td,{children:"Looks up values in a vector or array."}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:'=LOOKUP("x", A1:A10)'})}),(0,n.jsx)(d.td,{children:"\u2014"})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"LOWER"})}),(0,n.jsx)(d.td,{children:"Query, Rules"}),(0,n.jsx)(d.td,{children:"Converts text to lowercase."}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"=LOWER(notes)"})}),(0,n.jsx)(d.td,{children:"\u2014"})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"MATCH"})}),(0,n.jsx)(d.td,{children:"Query"}),(0,n.jsx)(d.td,{children:"Returns position of value in array."}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:'=MATCH("x", A1:A10, 0)'})}),(0,n.jsx)(d.td,{children:"\u2014"})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"MAX"})}),(0,n.jsx)(d.td,{children:"Query"}),(0,n.jsx)(d.td,{children:"Returns the maximum value."}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"=MAX(1, 2, 3)"})}),(0,n.jsx)(d.td,{children:"Accepts more than 2 values"})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"MAXA"})}),(0,n.jsx)(d.td,{children:"Query"}),(0,n.jsx)(d.td,{children:"Returns the maximum value, including text and logical values."}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:'=MAXA(1, TRUE, "2")'})}),(0,n.jsx)(d.td,{children:"Accepts more than 2 values"})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"MEDIAN"})}),(0,n.jsx)(d.td,{children:"Query"}),(0,n.jsx)(d.td,{children:"Returns the median value."}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"=MEDIAN(1, 2, 100)"})}),(0,n.jsx)(d.td,{children:"Accepts more than 2 values"})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"MID"})}),(0,n.jsx)(d.td,{children:"Query, Rules"}),(0,n.jsx)(d.td,{children:"Returns substring from specified position."}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"=MID(notes, 1, 10)"})}),(0,n.jsx)(d.td,{children:"\u2014"})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"MIN"})}),(0,n.jsx)(d.td,{children:"Query"}),(0,n.jsx)(d.td,{children:"Returns the minimum value."}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"=MIN(1, 2, 3)"})}),(0,n.jsx)(d.td,{children:"Accepts more than 2 values"})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"MINA"})}),(0,n.jsx)(d.td,{children:"Query"}),(0,n.jsx)(d.td,{children:"Returns the minimum value, including text and logical values."}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:'=MINA(1, TRUE, "2")'})}),(0,n.jsx)(d.td,{children:"Accepts more than 2 values"})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"MOD"})}),(0,n.jsx)(d.td,{children:"Query, Rules"}),(0,n.jsx)(d.td,{children:"Returns the remainder of division."}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"=MOD(10, 3)"})}),(0,n.jsx)(d.td,{children:"\u2014"})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"MODE"})}),(0,n.jsx)(d.td,{children:"Query"}),(0,n.jsx)(d.td,{children:"Returns the most frequently occurring value."}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"=MODE(1, 1, 2)"})}),(0,n.jsx)(d.td,{children:"Accepts more than 2 values"})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"MONTH"})}),(0,n.jsx)(d.td,{children:"Query, Rules"}),(0,n.jsx)(d.td,{children:"Returns the month from a date."}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"=MONTH(date)"})}),(0,n.jsx)(d.td,{children:"\u2014"})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"N"})}),(0,n.jsx)(d.td,{children:"Rules"}),(0,n.jsx)(d.td,{children:"Converts value to a number."}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"=N(TRUE())"})}),(0,n.jsx)(d.td,{children:"\u2014"})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"NETWORKDAYS"})}),(0,n.jsx)(d.td,{children:"Query"}),(0,n.jsx)(d.td,{children:"Returns number of working days between dates."}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:'=NETWORKDAYS("2025-12-01", "2025-12-31")'})}),(0,n.jsx)(d.td,{children:"\u2014"})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"NOT"})}),(0,n.jsx)(d.td,{children:"Query, Rules"}),(0,n.jsx)(d.td,{children:"Reverses the logical value."}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"=NOT(amount<0)"})}),(0,n.jsx)(d.td,{children:"\u2014"})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"NOW"})}),(0,n.jsx)(d.td,{children:"Query, Rules"}),(0,n.jsx)(d.td,{children:"Returns current date and time."}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"=NOW()"})}),(0,n.jsx)(d.td,{children:"\u2014"})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"NPV"})}),(0,n.jsx)(d.td,{children:"Query"}),(0,n.jsx)(d.td,{children:"Calculates net present value."}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"=NPV(0.1, -1000, 200, 300)"})}),(0,n.jsx)(d.td,{children:"Accepts more than 2 values"})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"OR"})}),(0,n.jsx)(d.td,{children:"Query, Rules"}),(0,n.jsx)(d.td,{children:"Returns TRUE if any argument is TRUE."}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"=OR(amount<0, amount>0)"})}),(0,n.jsx)(d.td,{children:"Accepts more than 2 conditions"})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"PERCENTILE"})}),(0,n.jsx)(d.td,{children:"Query"}),(0,n.jsx)(d.td,{children:"Returns the k-th percentile."}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"=PERCENTILE(A1:A100, 0.9)"})}),(0,n.jsx)(d.td,{children:"\u2014"})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"PI"})}),(0,n.jsx)(d.td,{children:"Query"}),(0,n.jsx)(d.td,{children:"Returns the value of PI."}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"=PI()"})}),(0,n.jsx)(d.td,{children:"\u2014"})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"PMT"})}),(0,n.jsx)(d.td,{children:"Query"}),(0,n.jsx)(d.td,{children:"Calculates payment for a loan."}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"=PMT(0.05/12, 60, 10000)"})}),(0,n.jsx)(d.td,{children:"\u2014"})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"POWER"})}),(0,n.jsx)(d.td,{children:"Query, Rules"}),(0,n.jsx)(d.td,{children:"Returns base raised to the power of exponent."}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"=POWER(2, 8)"})}),(0,n.jsx)(d.td,{children:"\u2014"})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"PROPER"})}),(0,n.jsx)(d.td,{children:"Query, Rules"}),(0,n.jsx)(d.td,{children:"Capitalizes first letter of each word."}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"=PROPER(notes)"})}),(0,n.jsx)(d.td,{children:"\u2014"})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"PRODUCT"})}),(0,n.jsx)(d.td,{children:"Query"}),(0,n.jsx)(d.td,{children:"Returns the product of all numbers."}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"=PRODUCT(2, 3, 4)"})}),(0,n.jsx)(d.td,{children:"Accepts more than 2 values"})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"PV"})}),(0,n.jsx)(d.td,{children:"Query"}),(0,n.jsx)(d.td,{children:"Calculates present value of investment."}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"=PV(0.05/12, 12, -100)"})}),(0,n.jsx)(d.td,{children:"\u2014"})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"QUARTILE"})}),(0,n.jsx)(d.td,{children:"Query"}),(0,n.jsx)(d.td,{children:"Returns the quartile of a dataset."}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"=QUARTILE(A1:A100, 1)"})}),(0,n.jsx)(d.td,{children:"\u2014"})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"QUERY"})}),(0,n.jsx)(d.td,{children:"Query"}),(0,n.jsx)(d.td,{children:"Execute a query and return the result."}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:'=QUERY("expenses")'})}),(0,n.jsx)(d.td,{children:"\u2014"})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"QUERY_COUNT"})}),(0,n.jsx)(d.td,{children:"Query"}),(0,n.jsx)(d.td,{children:"Execute a query and return the number of matching rows."}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:'=QUERY_COUNT("expenses")'})}),(0,n.jsx)(d.td,{children:"\u2014"})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"RANK"})}),(0,n.jsx)(d.td,{children:"Query"}),(0,n.jsx)(d.td,{children:"Returns the rank of a number in a list."}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"=RANK(10, A1:A10, 0)"})}),(0,n.jsx)(d.td,{children:"\u2014"})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"RATE"})}),(0,n.jsx)(d.td,{children:"Query"}),(0,n.jsx)(d.td,{children:"Calculates interest rate per period."}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"=RATE(60, -200, 10000)"})}),(0,n.jsx)(d.td,{children:"\u2014"})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"REPLACE"})}),(0,n.jsx)(d.td,{children:"Query, Rules"}),(0,n.jsx)(d.td,{children:"Replaces substring at specified position."}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:'=REPLACE(notes, 1, 5, "")'})}),(0,n.jsx)(d.td,{children:"\u2014"})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"REPT"})}),(0,n.jsx)(d.td,{children:"Query, Rules"}),(0,n.jsx)(d.td,{children:"Repeats text specified number of times."}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:'=REPT("*", 10)'})}),(0,n.jsx)(d.td,{children:"\u2014"})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"RIGHT"})}),(0,n.jsx)(d.td,{children:"Query, Rules"}),(0,n.jsx)(d.td,{children:"Returns rightmost characters from text."}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"=RIGHT(imported_payee, 4)"})}),(0,n.jsx)(d.td,{children:"\u2014"})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"ROUND"})}),(0,n.jsx)(d.td,{children:"Query, Rules"}),(0,n.jsx)(d.td,{children:"Rounds a number to specified decimals."}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"=ROUND(amount/100, 2)"})}),(0,n.jsx)(d.td,{children:"\u2014"})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"ROUNDDOWN"})}),(0,n.jsx)(d.td,{children:"Query, Rules"}),(0,n.jsx)(d.td,{children:"Rounds down to specified decimals."}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"=ROUNDDOWN(amount/100, 0)"})}),(0,n.jsx)(d.td,{children:"\u2014"})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"ROUNDUP"})}),(0,n.jsx)(d.td,{children:"Query, Rules"}),(0,n.jsx)(d.td,{children:"Rounds up to specified decimals."}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"=ROUNDUP(amount/100, 0)"})}),(0,n.jsx)(d.td,{children:"\u2014"})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"SEARCH"})}),(0,n.jsx)(d.td,{children:"Query, Rules"}),(0,n.jsx)(d.td,{children:"Finds text within text (case-insensitive, supports wildcards)."}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:'=SEARCH("foo", notes)'})}),(0,n.jsx)(d.td,{children:"\u2014"})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"SIGN"})}),(0,n.jsx)(d.td,{children:"Rules"}),(0,n.jsx)(d.td,{children:"Returns -1 for negative, 0 for zero, 1 for positive."}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"=SIGN(amount)"})}),(0,n.jsx)(d.td,{children:"\u2014"})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"SIN"})}),(0,n.jsx)(d.td,{children:"Query"}),(0,n.jsx)(d.td,{children:"Returns the sine of an angle."}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"=SIN(1)"})}),(0,n.jsx)(d.td,{children:"\u2014"})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"SPLIT"})}),(0,n.jsx)(d.td,{children:"Rules"}),(0,n.jsx)(d.td,{children:"Splits text by space and returns part at index."}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"=SPLIT(imported_payee, 0)"})}),(0,n.jsx)(d.td,{children:"\u2014"})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"SQRT"})}),(0,n.jsx)(d.td,{children:"Query, Rules"}),(0,n.jsx)(d.td,{children:"Returns the square root."}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"=SQRT(9)"})}),(0,n.jsx)(d.td,{children:"\u2014"})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"STDEV"})}),(0,n.jsx)(d.td,{children:"Query"}),(0,n.jsx)(d.td,{children:"Returns the standard deviation of a sample."}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"=STDEV(A1:A10)"})}),(0,n.jsx)(d.td,{children:"\u2014"})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"STDEVP"})}),(0,n.jsx)(d.td,{children:"Query"}),(0,n.jsx)(d.td,{children:"Returns the standard deviation of a population."}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"=STDEVP(A1:A10)"})}),(0,n.jsx)(d.td,{children:"\u2014"})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"SUBSTITUTE"})}),(0,n.jsx)(d.td,{children:"Query, Rules"}),(0,n.jsx)(d.td,{children:"Replaces occurrences of text."}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:'=SUBSTITUTE(imported_payee, " 12345", "")'})}),(0,n.jsx)(d.td,{children:"\u2014"})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"SUM"})}),(0,n.jsx)(d.td,{children:"Query, Rules"}),(0,n.jsx)(d.td,{children:"Returns the sum of all numbers in a range."}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"=SUM(1, 2, 3)"})}),(0,n.jsx)(d.td,{children:"Accepts more than 2 values"})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"SUMIF"})}),(0,n.jsx)(d.td,{children:"Query"}),(0,n.jsx)(d.td,{children:"Sums cells that meet a criteria."}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:'=SUMIF(A1:A10, ">0", B1:B10)'})}),(0,n.jsx)(d.td,{children:"\u2014"})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"SUMIFS"})}),(0,n.jsx)(d.td,{children:"Query"}),(0,n.jsx)(d.td,{children:"Sums cells that meet multiple criteria."}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:'=SUMIFS(B1:B10, A1:A10, ">0", C1:C10, "X")'})}),(0,n.jsxs)(d.td,{children:["Repeat ",(0,n.jsx)(d.code,{children:"(range, criteria)"})," pairs"]})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"SUMPRODUCT"})}),(0,n.jsx)(d.td,{children:"Query"}),(0,n.jsx)(d.td,{children:"Multiplies corresponding elements and returns the sum."}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"=SUMPRODUCT(A1:A10, B1:B10)"})}),(0,n.jsx)(d.td,{children:"Accepts more arrays"})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"SUMSQ"})}),(0,n.jsx)(d.td,{children:"Query"}),(0,n.jsx)(d.td,{children:"Returns the sum of the squares."}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"=SUMSQ(1, 2, 3)"})}),(0,n.jsx)(d.td,{children:"Accepts more than 2 values"})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"SWITCH"})}),(0,n.jsx)(d.td,{children:"Query, Rules"}),(0,n.jsx)(d.td,{children:"Matches expression against values and returns corresponding result."}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:'=SWITCH(category_name, "Groceries", "Food", "Fuel", "Transport")'})}),(0,n.jsxs)(d.td,{children:["Repeat ",(0,n.jsx)(d.code,{children:"(value, result)"})," pairs; default supported"]})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"T"})}),(0,n.jsx)(d.td,{children:"Rules"}),(0,n.jsx)(d.td,{children:"Returns text if value is text, empty string otherwise."}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"=T(notes)"})}),(0,n.jsx)(d.td,{children:"\u2014"})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"TAN"})}),(0,n.jsx)(d.td,{children:"Query"}),(0,n.jsx)(d.td,{children:"Returns the tangent of an angle."}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"=TAN(1)"})}),(0,n.jsx)(d.td,{children:"\u2014"})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"TEXT"})}),(0,n.jsx)(d.td,{children:"Query, Rules"}),(0,n.jsx)(d.td,{children:"Converts number to text with format."}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:'=TEXT(date, "MMMM yyyy")'})}),(0,n.jsx)(d.td,{children:"\u2014"})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"TODAY"})}),(0,n.jsx)(d.td,{children:"Query, Rules"}),(0,n.jsx)(d.td,{children:"Returns current date."}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"=TODAY()"})}),(0,n.jsx)(d.td,{children:"\u2014"})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"TRIM"})}),(0,n.jsx)(d.td,{children:"Query, Rules"}),(0,n.jsx)(d.td,{children:"Removes extra spaces from text."}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"=TRIM(notes)"})}),(0,n.jsx)(d.td,{children:"\u2014"})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"TRUNC"})}),(0,n.jsx)(d.td,{children:"Rules"}),(0,n.jsx)(d.td,{children:"Truncates number to specified decimals."}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"=TRUNC(amount/100, 0)"})}),(0,n.jsx)(d.td,{children:"\u2014"})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"TRUE"})}),(0,n.jsx)(d.td,{children:"Query, Rules"}),(0,n.jsx)(d.td,{children:"Returns the logical value TRUE."}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"=TRUE()"})}),(0,n.jsx)(d.td,{children:"\u2014"})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"UPPER"})}),(0,n.jsx)(d.td,{children:"Query, Rules"}),(0,n.jsx)(d.td,{children:"Converts text to uppercase."}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"=UPPER(notes)"})}),(0,n.jsx)(d.td,{children:"\u2014"})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"VALUE"})}),(0,n.jsx)(d.td,{children:"Rules"}),(0,n.jsx)(d.td,{children:"Converts text to a number."}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:'=VALUE("123.45")'})}),(0,n.jsx)(d.td,{children:"\u2014"})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"VAR"})}),(0,n.jsx)(d.td,{children:"Query"}),(0,n.jsx)(d.td,{children:"Returns the variance of a sample."}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"=VAR(A1:A10)"})}),(0,n.jsx)(d.td,{children:"\u2014"})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"VARP"})}),(0,n.jsx)(d.td,{children:"Query"}),(0,n.jsx)(d.td,{children:"Returns the variance of a population."}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"=VARP(A1:A10)"})}),(0,n.jsx)(d.td,{children:"\u2014"})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"VLOOKUP"})}),(0,n.jsx)(d.td,{children:"Query"}),(0,n.jsx)(d.td,{children:"Searches vertically in first column and returns value."}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:'=VLOOKUP("key", A1:D10, 2, TRUE)'})}),(0,n.jsx)(d.td,{children:"\u2014"})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"WEEKDAY"})}),(0,n.jsx)(d.td,{children:"Query, Rules"}),(0,n.jsx)(d.td,{children:"Returns day of week (1-7)."}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"=WEEKDAY(date, 1)"})}),(0,n.jsx)(d.td,{children:"\u2014"})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"WEEKNUM"})}),(0,n.jsx)(d.td,{children:"Query, Rules"}),(0,n.jsx)(d.td,{children:"Returns week number of year."}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"=WEEKNUM(date, 1)"})}),(0,n.jsx)(d.td,{children:"\u2014"})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"XOR"})}),(0,n.jsx)(d.td,{children:"Query, Rules"}),(0,n.jsx)(d.td,{children:"Returns TRUE if odd number of arguments are TRUE."}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"=XOR(TRUE(), FALSE())"})}),(0,n.jsx)(d.td,{children:"Accepts more than 2 conditions"})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"YEAR"})}),(0,n.jsx)(d.td,{children:"Query, Rules"}),(0,n.jsx)(d.td,{children:"Returns the year from a date."}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"=YEAR(date)"})}),(0,n.jsx)(d.td,{children:"\u2014"})]})]})]}),"\n",(0,n.jsxs)(d.h3,{id:"use-queries-with-queryname-and-query_countname",children:["Use queries with ",(0,n.jsx)(d.code,{children:'QUERY("name")'})," and ",(0,n.jsx)(d.code,{children:'QUERY_COUNT("name")'})]}),"\n",(0,n.jsxs)(d.p,{children:["Formula cards can reference ",(0,n.jsx)(d.strong,{children:"named queries"})," that you define in the right-side panel (",(0,n.jsx)(d.strong,{children:"Query Definitions"}),")."]}),"\n",(0,n.jsxs)(d.ul,{children:["\n",(0,n.jsxs)(d.li,{children:[(0,n.jsx)(d.code,{children:'QUERY("myQuery")'})," returns the ",(0,n.jsx)(d.strong,{children:"sum of transaction amounts"})," for that query\u2019s filters and date range (returned in normal \u201cmoney\u201d units, e.g. ",(0,n.jsx)(d.code,{children:"-123.45"}),")."]}),"\n",(0,n.jsxs)(d.li,{children:["If a query name doesn\u2019t exist, it evaluates as ",(0,n.jsx)(d.strong,{children:"0"}),"."]}),"\n"]}),"\n",(0,n.jsx)(d.p,{children:"Example:"}),"\n",(0,n.jsx)(d.pre,{children:(0,n.jsx)(d.code,{className:"language-text",children:'=QUERY("income") - QUERY("expenses")\n'})}),"\n",(0,n.jsx)(d.h3,{id:"define-a-query",children:"Define a query"}),"\n",(0,n.jsxs)(d.p,{children:["In the Formula editor page, use ",(0,n.jsx)(d.strong,{children:"Query Definitions"}),":"]}),"\n",(0,n.jsxs)(d.ol,{children:["\n",(0,n.jsxs)(d.li,{children:[(0,n.jsx)(d.strong,{children:"Add Query"})," and give it a name (the name is what you reference in ",(0,n.jsx)(d.code,{children:'QUERY("...")'}),")"]}),"\n",(0,n.jsxs)(d.li,{children:["Set the date range:","\n",(0,n.jsxs)(d.ul,{children:["\n",(0,n.jsxs)(d.li,{children:[(0,n.jsx)(d.strong,{children:"Live"}),": keeps the range moving (e.g. \u201clast 3 months\u201d)"]}),"\n",(0,n.jsxs)(d.li,{children:[(0,n.jsx)(d.strong,{children:"Static"}),": fixed start/end dates"]}),"\n"]}),"\n"]}),"\n",(0,n.jsxs)(d.li,{children:["Add ",(0,n.jsx)(d.strong,{children:"Filters"})," (same style as report filters)"]}),"\n"]}),"\n",(0,n.jsx)(d.p,{children:(0,n.jsx)(d.img,{alt:"Placeholder: formula editor and Query Definitions panel",src:r(85378).A+"",width:"2170",height:"1327"})}),"\n",(0,n.jsx)(d.h3,{id:"optional-conditional-color",children:"Optional: conditional color"}),"\n",(0,n.jsxs)(d.p,{children:["Formula cards support an optional ",(0,n.jsx)(d.strong,{children:"Conditional color"})," formula (single line) that returns a color string like ",(0,n.jsx)(d.code,{children:"red"})," or ",(0,n.jsx)(d.code,{children:"#ff0000"}),"."]}),"\n",(0,n.jsxs)(d.ul,{children:["\n",(0,n.jsxs)(d.li,{children:["Use the ",(0,n.jsx)(d.strong,{children:(0,n.jsx)(d.code,{children:"RESULT"})})," variable to reference the main formula result."]}),"\n"]}),"\n",(0,n.jsx)(d.h2,{id:"rule-formulas",children:"Rule formulas"}),"\n",(0,n.jsx)(d.p,{children:"Rule formulas let you compute a value from the current transaction and set a field to that computed result."}),"\n",(0,n.jsxs)(d.p,{children:["Note: rule formula inputs are ",(0,n.jsx)(d.strong,{children:"single-line"})," (line breaks are automatically replaced with spaces)."]}),"\n",(0,n.jsx)(d.h3,{id:"where-to-find-the-formula-toggle",children:"Where to find the formula toggle"}),"\n",(0,n.jsxs)(d.p,{children:["In ",(0,n.jsx)(d.strong,{children:"More -> Rules -> edit a rule"}),", on a ",(0,n.jsx)(d.strong,{children:"Set"})," action:"]}),"\n",(0,n.jsxs)(d.ul,{children:["\n",(0,n.jsxs)(d.li,{children:["Click the ",(0,n.jsx)(d.strong,{children:"\u0192"})," button to the right of the action input to enable/disable ",(0,n.jsx)(d.strong,{children:"formula mode"})," for that action."]}),"\n",(0,n.jsxs)(d.li,{children:["Formula mode is not available for actions that set ",(0,n.jsx)(d.strong,{children:"payee"}),", ",(0,n.jsx)(d.strong,{children:"category"}),", or ",(0,n.jsx)(d.strong,{children:"account"})," (those values are IDs)."]}),"\n",(0,n.jsxs)(d.li,{children:["Rule action templating (the ",(0,n.jsx)(d.code,{children:"</>"})," icon) and formulas are mutually exclusive: enabling one disables the other."]}),"\n"]}),"\n",(0,n.jsx)(d.p,{children:(0,n.jsx)(d.img,{alt:"Placeholder: Rule action formula toggle (\u0192)",src:r(58757).A+"",width:"1338",height:"718"})}),"\n",(0,n.jsx)(d.h3,{id:"available-variables",children:"Available variables"}),"\n",(0,n.jsx)(d.p,{children:"Rule formulas evaluate with named variables from the transaction context, including:"}),"\n",(0,n.jsx)(d.p,{children:(0,n.jsx)(d.strong,{children:"Date variables:"})}),"\n",(0,n.jsxs)(d.ul,{children:["\n",(0,n.jsxs)(d.li,{children:[(0,n.jsx)(d.code,{children:"today"})," \u2014 Current date in YYYY-MM-DD format (e.g., ",(0,n.jsx)(d.code,{children:'"2025-12-19"'}),")"]}),"\n",(0,n.jsxs)(d.li,{children:[(0,n.jsx)(d.code,{children:"date"})," \u2014 Transaction date in YYYY-MM-DD format (e.g., ",(0,n.jsx)(d.code,{children:'"2025-01-15"'}),")"]}),"\n"]}),"\n",(0,n.jsx)(d.p,{children:(0,n.jsx)(d.strong,{children:"Numeric variables (stored in cents):"})}),"\n",(0,n.jsxs)(d.ul,{children:["\n",(0,n.jsxs)(d.li,{children:[(0,n.jsx)(d.code,{children:"amount"})," \u2014 Transaction amount as an integer in cents (e.g., ",(0,n.jsx)(d.code,{children:"12345"})," represents $123.45)","\n",(0,n.jsxs)(d.ul,{children:["\n",(0,n.jsx)(d.li,{children:"Positive for income, negative for expenses"}),"\n",(0,n.jsxs)(d.li,{children:["To convert to dollars: ",(0,n.jsx)(d.code,{children:"=amount / 100"})]}),"\n"]}),"\n"]}),"\n",(0,n.jsxs)(d.li,{children:[(0,n.jsx)(d.code,{children:"balance"})," \u2014 Account balance after this transaction, as an integer in cents","\n",(0,n.jsxs)(d.ul,{children:["\n",(0,n.jsx)(d.li,{children:"Represents the running balance at this transaction"}),"\n",(0,n.jsxs)(d.li,{children:["To convert to dollars: ",(0,n.jsx)(d.code,{children:"=balance / 100"})]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,n.jsx)(d.p,{children:(0,n.jsx)(d.strong,{children:"Text variables:"})}),"\n",(0,n.jsxs)(d.ul,{children:["\n",(0,n.jsxs)(d.li,{children:[(0,n.jsx)(d.code,{children:"notes"})," \u2014 Transaction notes/memo field (string, may be empty)"]}),"\n",(0,n.jsxs)(d.li,{children:[(0,n.jsx)(d.code,{children:"imported_payee"})," \u2014 Original payee name from import before any rules applied (string)"]}),"\n",(0,n.jsxs)(d.li,{children:[(0,n.jsx)(d.code,{children:"payee_name"})," \u2014 Resolved payee name (string)"]}),"\n",(0,n.jsxs)(d.li,{children:[(0,n.jsx)(d.code,{children:"account_name"})," \u2014 Account name where transaction exists (string)"]}),"\n",(0,n.jsxs)(d.li,{children:[(0,n.jsx)(d.code,{children:"category_name"})," \u2014 Category name assigned to transaction (string)"]}),"\n"]}),"\n",(0,n.jsx)(d.p,{children:(0,n.jsx)(d.strong,{children:"Boolean variables:"})}),"\n",(0,n.jsxs)(d.ul,{children:["\n",(0,n.jsxs)(d.li,{children:[(0,n.jsx)(d.code,{children:"cleared"})," \u2014 Whether transaction is cleared (",(0,n.jsx)(d.code,{children:"TRUE"})," or ",(0,n.jsx)(d.code,{children:"FALSE"}),")"]}),"\n",(0,n.jsxs)(d.li,{children:[(0,n.jsx)(d.code,{children:"reconciled"})," \u2014 Whether transaction is reconciled (",(0,n.jsx)(d.code,{children:"TRUE"})," or ",(0,n.jsx)(d.code,{children:"FALSE"}),")"]}),"\n"]}),"\n",(0,n.jsxs)(d.p,{children:["Tip: if you want \u201cdollars\u201d from ",(0,n.jsx)(d.code,{children:"amount"}),", use ",(0,n.jsx)(d.code,{children:"=amount / 100"}),"."]}),"\n",(0,n.jsx)(d.h3,{id:"result-types",children:"Result types"}),"\n",(0,n.jsx)(d.p,{children:"When a rule runs, Actual converts the formula result to the field type:"}),"\n",(0,n.jsxs)(d.ul,{children:["\n",(0,n.jsxs)(d.li,{children:[(0,n.jsx)(d.strong,{children:"number fields"}),": must produce a number (or a string that parses as a number)"]}),"\n",(0,n.jsxs)(d.li,{children:[(0,n.jsx)(d.strong,{children:"date fields"}),": must produce a valid date"]}),"\n",(0,n.jsxs)(d.li,{children:[(0,n.jsx)(d.strong,{children:"boolean fields"}),": ",(0,n.jsx)(d.code,{children:"TRUE"}),"/",(0,n.jsx)(d.code,{children:"FALSE"})," (or a string that equals ",(0,n.jsx)(d.code,{children:'"true"'}),"/",(0,n.jsx)(d.code,{children:'"false"'}),")"]}),"\n",(0,n.jsxs)(d.li,{children:[(0,n.jsx)(d.strong,{children:"string fields"}),": converted with ",(0,n.jsx)(d.code,{children:"String(...)"})]}),"\n"]})]})}function j(e={}){const{wrapper:d}={...(0,l.R)(),...e.components};return d?(0,n.jsx)(d,{...e,children:(0,n.jsx)(x,{...e})}):x(e)}},69673:(e,d,r)=>{r.d(d,{A:()=>s});const s=r.p+"assets/images/enable-formula-mode-f4229cabd9ae411c3b383f8c4d964e0e.png"},71184:(e,d,r)=>{r.d(d,{R:()=>c,x:()=>i});var s=r(14041);const n={},l=s.createContext(n);function c(e){const d=s.useContext(l);return s.useMemo(function(){return"function"==typeof e?e(d):{...d,...e}},[d,e])}function i(e){let d;return d=e.disableParentContext?"function"==typeof e.components?e.components(n):e.components||n:c(e.components),s.createElement(l.Provider,{value:d},e.children)}},85378:(e,d,r)=>{r.d(d,{A:()=>s});const s=r.p+"assets/images/formula-editor-and-queries-0353d909755e2ee51eb21b624be3270f.png"}}]);