"use strict";(globalThis.webpackChunkdocs=globalThis.webpackChunkdocs||[]).push([[1831],{8976:(e,i,s)=>{s.r(i),s.d(i,{assets:()=>l,contentTitle:()=>d,default:()=>h,frontMatter:()=>r,metadata:()=>n,toc:()=>c});const n=JSON.parse('{"id":"config/index","title":"Configuring the Server","description":"When it starts up, Actual looks for an optional config.json file in the same directory as the sync-server\'s package.json. If you are building from source this will be in packages/sync-server/. If present, any keys you define there will override the default values. All values can also be specified as environment variables, which will override the values in the config.json file.","source":"@site/docs/config/index.md","sourceDirName":"config","slug":"/config/","permalink":"/docs/config/","draft":false,"unlisted":false,"editUrl":"https://github.com/actualbudget/actual/tree/master/packages/docs/docs/config/index.md","tags":[],"version":"current","frontMatter":{"title":"Configuring the Server"},"sidebar":"docs","previous":{"title":"Fly.io","permalink":"/docs/install/fly"},"next":{"title":"Activating HTTPS","permalink":"/docs/config/https"}}');var t=s(31085),o=s(71184);const r={title:"Configuring the Server"},d=void 0,l={},c=[{value:"<code>ACTUAL_DATA_DIR</code> (config.json: <code>dataDir</code>)",id:"actual_data_dir-configjson-datadir",level:2},{value:"<code>ACTUAL_CONFIG_PATH</code>",id:"actual_config_path",level:2},{value:"<code>ACTUAL_UPLOAD_FILE_SYNC_SIZE_LIMIT_MB</code>",id:"actual_upload_file_sync_size_limit_mb",level:2},{value:"<code>ACTUAL_UPLOAD_SYNC_ENCRYPTED_FILE_SYNC_SIZE_LIMIT_MB</code>",id:"actual_upload_sync_encrypted_file_sync_size_limit_mb",level:2},{value:"<code>ACTUAL_UPLOAD_FILE_SIZE_LIMIT_MB</code>",id:"actual_upload_file_size_limit_mb",level:2},{value:"<code>https</code>",id:"https",level:2},{value:"<code>port</code>",id:"port",level:2},{value:"<code>hostname</code>",id:"hostname",level:2},{value:"<code>serverFiles</code>",id:"serverfiles",level:2},{value:"<code>userFiles</code>",id:"userfiles",level:2},{value:"<code>webRoot</code>",id:"webroot",level:2},{value:"<code>loginMethod</code>",id:"loginmethod",level:2},{value:"<code>allowedLoginMethods</code>",id:"allowedloginmethods",level:2},{value:"<code>trustedProxies</code>",id:"trustedproxies",level:2},{value:"<code>trustedAuthProxies</code>",id:"trustedauthproxies",level:2}];function a(e){const i={a:"a",admonition:"admonition",code:"code",h2:"h2",li:"li",p:"p",ul:"ul",...(0,o.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(i.p,{children:["When it starts up, Actual looks for an optional ",(0,t.jsx)(i.code,{children:"config.json"})," file in the same directory as the sync-server's ",(0,t.jsx)(i.code,{children:"package.json"}),". If you are ",(0,t.jsx)(i.a,{href:"/docs/install/build-from-source",children:"building from source"})," this will be in ",(0,t.jsx)(i.code,{children:"packages/sync-server/"}),". If present, any keys you define there will override the default values. All values can also be specified as environment variables, which will override the values in the ",(0,t.jsx)(i.code,{children:"config.json"})," file."]}),"\n",(0,t.jsx)(i.admonition,{type:"caution",children:(0,t.jsxs)(i.p,{children:["Observe that the environmental variables do not map 1:1 to keys in the config.json file. In case of doubt, check the source schema at ",(0,t.jsx)(i.a,{href:"https://github.com/actualbudget/actual/blob/45530638feaacf74c28fddb846ae91170a99d94e/packages/sync-server/src/load-config.js#L43",children:"/packages/sync-server/src/load-config.js"})]})}),"\n",(0,t.jsx)(i.admonition,{type:"info",children:(0,t.jsxs)(i.p,{children:["Running into issues with your configuration not being interpreted correctly? Check out our documentation for ",(0,t.jsx)(i.a,{href:"/docs/troubleshooting/server",children:"troubleshooting the server"})," for information on how to enable debug logging to track down the issue."]})}),"\n",(0,t.jsxs)(i.h2,{id:"actual_data_dir-configjson-datadir",children:[(0,t.jsx)(i.code,{children:"ACTUAL_DATA_DIR"})," (config.json: ",(0,t.jsx)(i.code,{children:"dataDir"}),")"]}),"\n",(0,t.jsxs)(i.p,{children:["This is where the server stores the budget data files (and configurations unless ",(0,t.jsx)(i.code,{children:"ACTUAL_CONFIG_PATH"})," is set)."]}),"\n",(0,t.jsxs)(i.p,{children:["By default, the server will use the ",(0,t.jsx)(i.code,{children:"/data"})," directory if it exists, or the current directory (",(0,t.jsx)(i.code,{children:"/"}),") if not."]}),"\n",(0,t.jsxs)(i.p,{children:["See also sections on ",(0,t.jsx)(i.code,{children:"userFiles"})," and ",(0,t.jsx)(i.code,{children:"serverFiles"}),"."]}),"\n",(0,t.jsx)(i.h2,{id:"actual_config_path",children:(0,t.jsx)(i.code,{children:"ACTUAL_CONFIG_PATH"})}),"\n",(0,t.jsxs)(i.p,{children:["This is the path to the config file. If not specified, the server will look for a ",(0,t.jsx)(i.code,{children:"config.json"})," file in the\n",(0,t.jsx)(i.code,{children:"/data"})," folder if it is present or in the sync-server's root directory if ",(0,t.jsx)(i.code,{children:"/data"})," is absent."]}),"\n",(0,t.jsxs)(i.p,{children:["See the ",(0,t.jsx)(i.code,{children:"ACTUAL_DATA_DIR"})," section above to override the data folder location."]}),"\n",(0,t.jsxs)(i.p,{children:["You can\u2019t specify this option in ",(0,t.jsx)(i.code,{children:"config.json"})," since it needs to be used to find the ",(0,t.jsx)(i.code,{children:"config.json"})," in the first place."]}),"\n",(0,t.jsx)(i.h2,{id:"actual_upload_file_sync_size_limit_mb",children:(0,t.jsx)(i.code,{children:"ACTUAL_UPLOAD_FILE_SYNC_SIZE_LIMIT_MB"})}),"\n",(0,t.jsx)(i.p,{children:"Defines the maximum allowed size for sync files (in MB)."}),"\n",(0,t.jsxs)(i.p,{children:["The default value is ",(0,t.jsx)(i.code,{children:"20"}),"."]}),"\n",(0,t.jsx)(i.h2,{id:"actual_upload_sync_encrypted_file_sync_size_limit_mb",children:(0,t.jsx)(i.code,{children:"ACTUAL_UPLOAD_SYNC_ENCRYPTED_FILE_SYNC_SIZE_LIMIT_MB"})}),"\n",(0,t.jsx)(i.p,{children:"Defines the maximum allowed size for encrypted sync files (in MB)."}),"\n",(0,t.jsxs)(i.p,{children:["The default value is ",(0,t.jsx)(i.code,{children:"50"}),"."]}),"\n",(0,t.jsx)(i.h2,{id:"actual_upload_file_size_limit_mb",children:(0,t.jsx)(i.code,{children:"ACTUAL_UPLOAD_FILE_SIZE_LIMIT_MB"})}),"\n",(0,t.jsx)(i.p,{children:"Defines the general maximum file size limit (in MB) for uploads."}),"\n",(0,t.jsxs)(i.p,{children:["The default value is ",(0,t.jsx)(i.code,{children:"20"}),"."]}),"\n",(0,t.jsx)(i.h2,{id:"https",children:(0,t.jsx)(i.code,{children:"https"})}),"\n",(0,t.jsx)(i.p,{children:"If you want Actual to serve over HTTPS, you can set this key to an object with the following keys:"}),"\n",(0,t.jsxs)(i.ul,{children:["\n",(0,t.jsxs)(i.li,{children:[(0,t.jsx)(i.code,{children:"key"}),": The path to the private key file. (environment variable: ",(0,t.jsx)(i.code,{children:"ACTUAL_HTTPS_KEY"}),")"]}),"\n",(0,t.jsxs)(i.li,{children:[(0,t.jsx)(i.code,{children:"cert"}),": The path to the certificate file. (environment variable: ",(0,t.jsx)(i.code,{children:"ACTUAL_HTTPS_CERT"}),")"]}),"\n",(0,t.jsxs)(i.li,{children:["any other options from Node's ",(0,t.jsx)(i.a,{href:"https://nodejs.org/api/tls.html#tlscreateserveroptions-secureconnectionlistener",children:(0,t.jsx)(i.code,{children:"tls.createServer()"})}),", ",(0,t.jsx)(i.a,{href:"https://nodejs.org/api/tls.html#tlscreatesecurecontextoptions",children:(0,t.jsx)(i.code,{children:"tls.createSecureContext()"})}),", or ",(0,t.jsx)(i.a,{href:"https://nodejs.org/api/http.html#httpcreateserveroptions-requestlistener",children:(0,t.jsx)(i.code,{children:"http.createServer()"})})," functions (optional, most people won't need to set any of these)."]}),"\n"]}),"\n",(0,t.jsxs)(i.p,{children:["See ",(0,t.jsx)(i.a,{href:"/docs/config/https",children:"Activating HTTPS"})," for more information on how to get HTTPS working."]}),"\n",(0,t.jsx)(i.h2,{id:"port",children:(0,t.jsx)(i.code,{children:"port"})}),"\n",(0,t.jsxs)(i.p,{children:["The ",(0,t.jsx)(i.code,{children:"port"})," key is used to specify the port that the server should listen on. If not specified, the server will listen on port 5006. (environment variable: ",(0,t.jsx)(i.code,{children:"ACTUAL_PORT"}),")"]}),"\n",(0,t.jsx)(i.h2,{id:"hostname",children:(0,t.jsx)(i.code,{children:"hostname"})}),"\n",(0,t.jsxs)(i.p,{children:["The ",(0,t.jsx)(i.code,{children:"hostname"})," key is used to specify the hostname that the server should listen on. If not specified, the server will listen on ",(0,t.jsx)(i.code,{children:"::"})," (which, on most operating systems, will include both IPv4 and IPv6). (environment variable: ",(0,t.jsx)(i.code,{children:"ACTUAL_HOSTNAME"}),")"]}),"\n",(0,t.jsx)(i.h2,{id:"serverfiles",children:(0,t.jsx)(i.code,{children:"serverFiles"})}),"\n",(0,t.jsxs)(i.p,{children:["The server will put an ",(0,t.jsx)(i.code,{children:"account.sqlite"})," file in this directory, which will contain the (hashed) server password, a list of all the budget files the server knows about, and the active session token (along with anything else the server may want to store in the future). If not specified, the server will use either ",(0,t.jsx)(i.code,{children:"/data/server-files"})," (if ",(0,t.jsx)(i.code,{children:"/data"})," exists) or the ",(0,t.jsx)(i.code,{children:"server-files"})," directory in the same directory as the ",(0,t.jsx)(i.code,{children:"package.json"}),". (environment variable: ",(0,t.jsx)(i.code,{children:"ACTUAL_SERVER_FILES"}),")"]}),"\n",(0,t.jsxs)(i.p,{children:["See the ",(0,t.jsx)(i.code,{children:"ACTUAL_DATA_DIR"})," section above to override the data folder location."]}),"\n",(0,t.jsx)(i.h2,{id:"userfiles",children:(0,t.jsx)(i.code,{children:"userFiles"})}),"\n",(0,t.jsxs)(i.p,{children:["The server will put all the budget files in this directory as binary blobs. If not specified, the server will use either ",(0,t.jsx)(i.code,{children:"/data/user-files"})," (if ",(0,t.jsx)(i.code,{children:"/data"})," exists) or the ",(0,t.jsx)(i.code,{children:"user-files"})," directory in the same directory as the ",(0,t.jsx)(i.code,{children:"package.json"}),". (environment variable: ",(0,t.jsx)(i.code,{children:"ACTUAL_USER_FILES"}),")"]}),"\n",(0,t.jsxs)(i.p,{children:["See the ",(0,t.jsx)(i.code,{children:"ACTUAL_DATA_DIR"})," section above to override the data folder location."]}),"\n",(0,t.jsx)(i.h2,{id:"webroot",children:(0,t.jsx)(i.code,{children:"webRoot"})}),"\n",(0,t.jsxs)(i.p,{children:["(Advanced, most people will not need to configure this.) The server will serve the frontend from this directory. If not specified, the server will use the files in the ",(0,t.jsx)(i.code,{children:"@actual-app/web"})," package that it has installed. (environment variable: ",(0,t.jsx)(i.code,{children:"ACTUAL_WEB_ROOT"}),")"]}),"\n",(0,t.jsxs)(i.p,{children:["If you\u2019re providing a custom frontend, make sure you provide an ",(0,t.jsx)(i.code,{children:"index.html"})," in the top level of the ",(0,t.jsx)(i.code,{children:"webRoot"})," directory, which will be served from the ",(0,t.jsx)(i.code,{children:"/"})," route."]}),"\n",(0,t.jsx)(i.h2,{id:"loginmethod",children:(0,t.jsx)(i.code,{children:"loginMethod"})}),"\n",(0,t.jsxs)(i.p,{children:["Change the default authentication method for Actual (environment variable: ",(0,t.jsx)(i.code,{children:"ACTUAL_LOGIN_METHOD"}),"). The valid values are:"]}),"\n",(0,t.jsxs)(i.ul,{children:["\n",(0,t.jsxs)(i.li,{children:[(0,t.jsx)(i.code,{children:'"password"'})," (default) - This is standard password authentication"]}),"\n",(0,t.jsxs)(i.li,{children:[(0,t.jsx)(i.code,{children:'"header"'})," - Use the HTTP header ",(0,t.jsx)(i.code,{children:"x-actual-password"})," to automatically login. This is for advanced use and if not done correctly could have security implications."]}),"\n",(0,t.jsxs)(i.li,{children:[(0,t.jsx)(i.code,{children:'"openid"'})," - OpenId auth (in preview)"]}),"\n"]}),"\n",(0,t.jsx)(i.h2,{id:"allowedloginmethods",children:(0,t.jsx)(i.code,{children:"allowedLoginMethods"})}),"\n",(0,t.jsxs)(i.p,{children:["The list of login methods that are permitted for auth. This defaults to ",(0,t.jsx)(i.code,{children:"['password','header','openid']"})," (environment variable: ",(0,t.jsx)(i.code,{children:"ACTUAL_ALLOWED_LOGIN_METHODS"}),", comma separated string)."]}),"\n",(0,t.jsx)(i.p,{children:"If you wish to restrict the server from accepting certain login methods, you should update this setting."}),"\n",(0,t.jsx)(i.h2,{id:"trustedproxies",children:(0,t.jsx)(i.code,{children:"trustedProxies"})}),"\n",(0,t.jsxs)(i.p,{children:["Updates the servers request forwarding trust to remove known proxy IPs from the client IP list. This helps identify the client IP for things like rate limiting. This defaults to known internal IP ranges: ",(0,t.jsx)(i.code,{children:"[10.0.0.0/8, 172.16.0.0/12, 192.168.0.0/16, fc00::/7, ::1/128]"})," (environment variable: ",(0,t.jsx)(i.code,{children:"ACTUAL_TRUSTED_PROXIES"}),", comma separated string)."]}),"\n",(0,t.jsx)(i.h2,{id:"trustedauthproxies",children:(0,t.jsx)(i.code,{children:"trustedAuthProxies"})}),"\n",(0,t.jsxs)(i.p,{children:["Configure the clients that are allowed to authenticate with HTTP headers. This defaults to what is set in ",(0,t.jsx)(i.code,{children:"trustedProxies"}),", but can be overridden independently. (environment variable: ",(0,t.jsx)(i.code,{children:"ACTUAL_TRUSTED_AUTH_PROXIES"}),", comma separated string)."]})]})}function h(e={}){const{wrapper:i}={...(0,o.R)(),...e.components};return i?(0,t.jsx)(i,{...e,children:(0,t.jsx)(a,{...e})}):a(e)}},71184:(e,i,s)=>{s.d(i,{R:()=>r,x:()=>d});var n=s(14041);const t={},o=n.createContext(t);function r(e){const i=n.useContext(o);return n.useMemo(function(){return"function"==typeof e?e(i):{...i,...e}},[i,e])}function d(e){let i;return i=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:r(e.components),n.createElement(o.Provider,{value:i},e.children)}}}]);