"use strict";(globalThis.webpackChunkdocs=globalThis.webpackChunkdocs||[]).push([[8085],{71184:(e,n,t)=>{t.d(n,{R:()=>s,x:()=>l});var a=t(14041);const r={},o=a.createContext(r);function s(e){const n=a.useContext(o);return a.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:s(e.components),a.createElement(o.Provider,{value:n},e.children)}},92143:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>c,contentTitle:()=>l,default:()=>p,frontMatter:()=>s,metadata:()=>a,toc:()=>i});const a=JSON.parse('{"id":"api/actual-ql/examples","title":"ActualQL Examples","description":"Searching by Month or Year","source":"@site/docs/api/actual-ql/examples.md","sourceDirName":"api/actual-ql","slug":"/api/actual-ql/examples","permalink":"/docs/api/actual-ql/examples","draft":false,"unlisted":false,"editUrl":"https://github.com/actualbudget/actual/tree/master/packages/docs/docs/api/actual-ql/examples.md","tags":[],"version":"current","frontMatter":{},"sidebar":"docs","previous":{"title":"ActualQL Functions","permalink":"/docs/api/actual-ql/functions"},"next":{"title":"Frequently Asked Questions","permalink":"/docs/faq"}}');var r=t(31085),o=t(71184);const s={},l="ActualQL Examples",c={},i=[{value:"Searching by Month or Year",id:"searching-by-month-or-year",level:2},{value:"Total Amount per Payee Between 6 Apr 2020 and 5 Apr 2021",id:"total-amount-per-payee-between-6-apr-2020-and-5-apr-2021",level:2},{value:"Total Amount of all Transactions With Note Containing #interest (P) Between 6 Apr 2020 and 5 Apr 2021",id:"total-amount-of-all-transactions-with-note-containing-interest-p-between-6-apr-2020-and-5-apr-2021",level:2},{value:"Total Amount per Category Between 6 Apr 2020 and 5 Apr 2021",id:"total-amount-per-category-between-6-apr-2020-and-5-apr-2021",level:2}];function d(e){const n={code:"code",h1:"h1",h2:"h2",header:"header",p:"p",pre:"pre",...(0,o.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"actualql-examples",children:"ActualQL Examples"})}),"\n",(0,r.jsx)(n.h2,{id:"searching-by-month-or-year",children:"Searching by Month or Year"}),"\n",(0,r.jsxs)(n.p,{children:["ActualQL supports various functions to convert data, as well as the ability to convert field data. For example, saying ",(0,r.jsx)(n.code,{children:"{ $month: '2021-01-01' }"})," would come back with the month of ",(0,r.jsx)(n.code,{children:"2021-01"}),". But we need a way to apply that to the ",(0,r.jsx)(n.code,{children:"date"})," field, and we use ",(0,r.jsx)(n.code,{children:"$transform"})," for that."]}),"\n",(0,r.jsx)(n.p,{children:"This part deserves better docs, but here's a reference example you can use to search by month or year:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-js",children:"q('transactions')\n  .filter({ date: { $transform: '$month', $eq: '2021-01' } })\n  .select('*');\n"})}),"\n",(0,r.jsxs)(n.p,{children:["This would return all transactions in the month of ",(0,r.jsx)(n.code,{children:"2021-01"}),". We've applied the ",(0,r.jsx)(n.code,{children:"$month"})," function to the ",(0,r.jsx)(n.code,{children:"date"})," field and applied the condition of equaling ",(0,r.jsx)(n.code,{children:"2021-01"}),"."]}),"\n",(0,r.jsxs)(n.p,{children:["You can substitute ",(0,r.jsx)(n.code,{children:"$year"})," to do the same thing for year."]}),"\n",(0,r.jsx)(n.h2,{id:"total-amount-per-payee-between-6-apr-2020-and-5-apr-2021",children:"Total Amount per Payee Between 6 Apr 2020 and 5 Apr 2021"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-js",children:"(\n  await $query(\n    $q('transactions')\n      .filter({\n        $and: [\n          { date: { $gte: '2020-04-06' } },\n          { date: { $lte: '2021-04-05' } },\n        ],\n      })\n      .groupBy('payee.name')\n      .orderBy('payee.name')\n      .select(['payee.name', { amount: { $sum: '$amount' } }]),\n  )\n).data.map(row => {\n  console.log(`${row['payee.name']}: ${row.amount / 100}`);\n});\n"})}),"\n",(0,r.jsx)(n.h2,{id:"total-amount-of-all-transactions-with-note-containing-interest-p-between-6-apr-2020-and-5-apr-2021",children:"Total Amount of all Transactions With Note Containing #interest (P) Between 6 Apr 2020 and 5 Apr 2021"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-js",children:"(\n  await $query(\n    $q('transactions')\n      .filter({\n        $and: [\n          { date: { $gte: '2020-04-06' } },\n          { date: { $lte: '2021-04-05' } },\n          { notes: { $like: '%#interest (P)%' } },\n        ],\n      })\n      .calculate({ $sum: '$amount' }),\n  )\n).data / 100;\n"})}),"\n",(0,r.jsx)(n.p,{children:"or"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-js",children:"(\n  await $query(\n    $q('transactions')\n      .filter({\n        $and: [\n          { date: { $gte: '2020-04-06' } },\n          { date: { $lte: '2021-04-05' } },\n          { notes: { $like: '%#interest (P)%' } },\n        ],\n      })\n      .select({ total: { $sum: '$amount' } }),\n  )\n).data[0].total / 100;\n"})}),"\n",(0,r.jsx)(n.h2,{id:"total-amount-per-category-between-6-apr-2020-and-5-apr-2021",children:"Total Amount per Category Between 6 Apr 2020 and 5 Apr 2021"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-js",children:"(\n  await $query(\n    $q('transactions')\n      .filter({\n        $and: [\n          { date: { $gte: '2020-04-06' } },\n          { date: { $lte: '2021-04-05' } },\n        ],\n      })\n      .groupBy('category.name')\n      .orderBy(['category.group.sort_order', 'category.sort_order'])\n      .select([\n        'category.group.name',\n        'category.name',\n        { amount: { $sum: '$amount' } },\n      ]),\n  )\n).data.map(row => {\n  console.log(\n    `${row['category.group.name']}/${row['category.name']}: ${\n      row.amount / 100\n    }`,\n  );\n});\n"})})]})}function p(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(d,{...e})}):d(e)}}}]);